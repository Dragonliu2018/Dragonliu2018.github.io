<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="https://dragonliu2018.github.io/atom.xml" rel="self"/>
  
  <link href="https://dragonliu2018.github.io/"/>
  <updated>2025-09-25T16:31:25.463Z</updated>
  <id>https://dragonliu2018.github.io/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[Tool] C++ benchmark</title>
    <link href="https://dragonliu2018.github.io/2025/09/26/Tool-C-benchmark/"/>
    <id>https://dragonliu2018.github.io/2025/09/26/Tool-C-benchmark/</id>
    <published>2025-09-25T16:30:37.000Z</published>
    <updated>2025-09-25T16:31:25.463Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-ç¼–è¯‘"><a class="markdownIt-Anchor" href="#1-ç¼–è¯‘"></a> 1 ç¼–è¯‘</h1><ol><li><p>clone ä»“åº“ï¼š<code>git clone https://github.com/google/benchmark.git</code></p></li><li><p>æ–°å»º buildï¼š</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> benchmark</span><br><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">cd</span> build</span><br></pre></td></tr></table></figure></li><li><p>cmake &amp; ä¸‹è½½ä¾èµ–:</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmake -DBENCHMARK_DOWNLOAD_DEPENDENCIES=on -DCMAKE_BUILD_TYPE=Release ../</span><br></pre></td></tr></table></figure></li><li><p>ç¼–è¯‘ï¼š</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmake --build <span class="string">&quot;build&quot;</span> --config Release</span><br></pre></td></tr></table></figure></li></ol><h1 id="2-ç¼–å†™æµ‹è¯•"><a class="markdownIt-Anchor" href="#2-ç¼–å†™æµ‹è¯•"></a> 2 ç¼–å†™æµ‹è¯•</h1><h1 id="3-åœ¨çº¿-benchmark"><a class="markdownIt-Anchor" href="#3-åœ¨çº¿-benchmark"></a> 3 åœ¨çº¿ benchmark</h1><p><a href="https://quick-bench.com/q/6tDxsmk3FMX55B8W1RrdiG_s7_k">https://quick-bench.com/q/6tDxsmk3FMX55B8W1RrdiG_s7_k</a></p><h1 id="x-å‚è€ƒ"><a class="markdownIt-Anchor" href="#x-å‚è€ƒ"></a> X å‚è€ƒ</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-ç¼–è¯‘&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-ç¼–è¯‘&quot;&gt;&lt;/a&gt; 1 ç¼–è¯‘&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;clone ä»“åº“ï¼š&lt;code&gt;git clone https://github.com/google/bench</summary>
      
    
    
    
    <category term="PL" scheme="https://dragonliu2018.github.io/categories/PL/"/>
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="C++" scheme="https://dragonliu2018.github.io/categories/PL/C/"/>
    
    <category term="è°ƒä¼˜" scheme="https://dragonliu2018.github.io/categories/Tool/%E8%B0%83%E4%BC%98/"/>
    
    
  </entry>
  
  <entry>
    <title>[Tool] gperf å®‰è£…ä½¿ç”¨æ•™ç¨‹</title>
    <link href="https://dragonliu2018.github.io/2025/09/26/Tool-gperf-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>https://dragonliu2018.github.io/2025/09/26/Tool-gperf-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</id>
    <published>2025-09-25T16:28:23.000Z</published>
    <updated>2025-09-25T16:28:47.582Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-ä»‹ç»"><a class="markdownIt-Anchor" href="#1-ä»‹ç»"></a> 1 ä»‹ç»</h1><p><a href="https://github.com/gperftools/gperftools">https://github.com/gperftools/gperftools</a></p><p><a href="https://github.com/gperftools/gperftools">gperftools</a>Â æ˜¯è°·æ­Œæ¨å‡ºçš„ä¸€å¥—éå¸¸å¼ºå¤§çš„æ€§èƒ½åˆ†æå·¥å…·é›†. å®ƒä¸»è¦æœ‰è¿™ä¸‰ä¸ªåŠŸèƒ½:</p><ul><li>åˆ†æ CPU æ€§èƒ½, èƒ½å¤Ÿç»Ÿè®¡å‡ºä¸€æ®µæ—¶é—´å†…å„ä¸ªå‡½æ•°çš„æ‰§è¡Œæ—¶é—´, å¸®åŠ©æˆ‘ä»¬æ‰¾å‡ºè€—æ—¶çš„ä»£ç ;</li><li>åˆ†æå†…å­˜å ç”¨æƒ…å†µ, èƒ½å¤Ÿç»Ÿè®¡å‡ºæŸä¸€æ—¶åˆ»å„ä¸ªå‡½æ•°åˆ†é…çš„å†…å­˜å¤§å°, å¸®åŠ©æˆ‘ä»¬æ‰¾å‡ºå†…å­˜å ç”¨é«˜çš„ä»£ç , ä¹Ÿèƒ½å¸®åŠ©æˆ‘ä»¬å®šä½å†…å­˜æ³„éœ²;</li><li>è‡ªåŠ¨æ£€æŸ¥å†…å­˜æ³„éœ².</li></ul><p>gperftools è¿˜åŒ…å«ä¸€ä¸ªé«˜æ€§èƒ½å†…å­˜åˆ†é…å™¨ tcmalloc, æˆ‘ä»¬å¯ä»¥ç”¨å®ƒä»£æ›¿ glibc çš„ ptmalloc. tcmalloc è‡ªå¸¦ç»Ÿè®¡åŠŸèƒ½, å†…å­˜åˆ†æå’Œæ£€æŸ¥å†…å­˜æ³„éœ²å°±é å®ƒ.</p><p>æœ¬æ–‡ä»‹ç» gperftools åœ¨ Linux ä¸‹çš„ä¸€äº›å¸¸è§çš„ç”¨æ³•. å¦‚æœä½ éœ€è¦ä½¿ç”¨ gperftools åˆ†æ Linux (æœåŠ¡å™¨) ç¨‹åº, è¿™ç¯‡æ–‡ç« å¯ä»¥å½“ä½œä¸€ä¸ª Quick Start.</p><h1 id="2-å®‰è£…"><a class="markdownIt-Anchor" href="#2-å®‰è£…"></a> 2 å®‰è£…</h1><p><strong>æ–¹æ³•1ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ruby -e <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>&quot;</span> &lt; /dev/null 2&gt; /dev/null</span><br></pre></td></tr></table></figure><p><strong>æ–¹æ³•2:</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install gperftools</span><br></pre></td></tr></table></figure><h1 id="3-ä½¿ç”¨"><a class="markdownIt-Anchor" href="#3-ä½¿ç”¨"></a> 3 ä½¿ç”¨</h1><h1 id="x-å‚è€ƒ"><a class="markdownIt-Anchor" href="#x-å‚è€ƒ"></a> X å‚è€ƒ</h1><ul><li><a href="https://stackoverflow.com/questions/23200704/install-perf-on-mac"><strong>Install â€œperfâ€ on Mac</strong></a></li><li><a href="https://luyuhuang.tech/2022/04/10/gperftools.html"><strong>ä½¿ç”¨ gperftools åˆ†æç¨‹åºæ€§èƒ½</strong></a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-ä»‹ç»&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-ä»‹ç»&quot;&gt;&lt;/a&gt; 1 ä»‹ç»&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/gperftools/gperftools&quot;&gt;https://github.</summary>
      
    
    
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="è°ƒä¼˜" scheme="https://dragonliu2018.github.io/categories/Tool/%E8%B0%83%E4%BC%98/"/>
    
    
  </entry>
  
  <entry>
    <title>[Tool] perf å®‰è£…ä½¿ç”¨æ•™ç¨‹</title>
    <link href="https://dragonliu2018.github.io/2025/09/26/Tool-perf-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>https://dragonliu2018.github.io/2025/09/26/Tool-perf-%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</id>
    <published>2025-09-25T16:24:37.000Z</published>
    <updated>2025-09-25T16:28:35.585Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-ubuntu-å®‰è£…æ­¥éª¤"><a class="markdownIt-Anchor" href="#1-ubuntu-å®‰è£…æ­¥éª¤"></a> 1 ubuntu å®‰è£…æ­¥éª¤</h1><ol><li><p>å®‰è£…<code>linux-tools-common</code>ï¼š</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install linux-tools-common</span><br></pre></td></tr></table></figure></li><li><p>æ­¤æ—¶è¿è¡Œperfä»ç„¶å¤±è´¥ï¼š</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  matrixdb git:(main) âœ— perf</span><br><span class="line">WARNING: perf not found <span class="keyword">for</span> kernel 5.15.0-69</span><br><span class="line"></span><br><span class="line">  You may need to install the following packages <span class="keyword">for</span> this specific kernel:</span><br><span class="line">    linux-tools-5.15.0-69-generic</span><br><span class="line">    linux-cloud-tools-5.15.0-69-generic</span><br><span class="line"></span><br><span class="line">  You may also want to install one of the following packages to keep up to <span class="built_in">date</span>:</span><br><span class="line">    linux-tools-generic</span><br><span class="line">    linux-cloud-tools-generic</span><br></pre></td></tr></table></figure></li><li><p>æ ¹æ®æç¤ºå…ˆè¿›è¡Œå¯¹åº”åŒ…çš„æ›´æ–°ï¼š</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install linux-tools-generic linux-cloud-tools-generic</span><br></pre></td></tr></table></figure></li><li><p>ä¸‹è½½å¯¹åº”åŒ…ï¼š</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install linux-tools-5.15.0-69-generic linux-cloud-tools-5.15.0-69-generic</span><br></pre></td></tr></table></figure></li><li><p>è¿›è¡ŒéªŒè¯ï¼Œä¸‹è½½æˆåŠŸï¼š</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  matrixdb git:(main) âœ— perf -v</span><br><span class="line">perf version 5.15.87</span><br></pre></td></tr></table></figure></li></ol><h1 id="2-å¸è½½"><a class="markdownIt-Anchor" href="#2-å¸è½½"></a> 2 å¸è½½</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get remove linux-tools-common linux-tools-$(<span class="built_in">uname</span> -r) linux-cloud-tools-$(<span class="built_in">uname</span> -r)</span><br></pre></td></tr></table></figure><h1 id="3-æŠ¥é”™"><a class="markdownIt-Anchor" href="#3-æŠ¥é”™"></a> 3 æŠ¥é”™</h1><h2 id="31-æŠ¥é”™1the-cpu_corecycles-event-is-not-supported"><a class="markdownIt-Anchor" href="#31-æŠ¥é”™1the-cpu_corecycles-event-is-not-supported"></a> 3.1 æŠ¥é”™1ï¼šThe cpu_core/cycles/ event is not supported.</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  build git:(p1) âœ— <span class="built_in">sudo</span> perf record ./test/buffer_pool_manager_instance_test</span><br><span class="line">Error:</span><br><span class="line">The cpu_core/cycles/ event is not supported.</span><br></pre></td></tr></table></figure><p>åœ¨å…¬å¸ macbook ä¸Šæ²¡æœ‰å‡ºç°æŠ¥é”™ï¼Œåœ¨å®éªŒå®¤ win11 ä¸Šå‡ºç°ä¸Šè¿°é—®é¢˜ã€‚</p><p><strong>å‚è€ƒ</strong> <a href="https://www.cnblogs.com/azureology/p/13913540.html">è™šæ‹ŸæœºLinuxä½¿ç”¨perf statæç¤ºcycles not supported</a>ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li>å…³é—­VMwareè™šæ‹Ÿæœºç”µæºï¼Œæ‰¾åˆ°ç¡¬ä»¶é…ç½®é€‰é¡¹ä¸­CPU</li><li>å‹¾é€‰<code>â˜‘ï¸è™šæ‹ŸåŒ–CPUæ€§èƒ½è®¡æ•°å™¨</code></li><li>é‡å¯é—®é¢˜è§£å†³ï¼ˆä½†æ˜¯æˆ‘çš„æœºå™¨å‹¾é€‰åæ— æ³•å¯åŠ¨è™šæ‹Ÿæœºäº†ğŸ¥¦</li></ol><h1 id="4-ä½¿ç”¨"><a class="markdownIt-Anchor" href="#4-ä½¿ç”¨"></a> 4 ä½¿ç”¨</h1><h2 id="41-æŠ“å–æ€§èƒ½ä¿¡æ¯"><a class="markdownIt-Anchor" href="#41-æŠ“å–æ€§èƒ½ä¿¡æ¯"></a> 4.1 æŠ“å–æ€§èƒ½ä¿¡æ¯</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›ç¨‹</span></span><br><span class="line"><span class="built_in">sudo</span> perf record --call-graph=dwarf -p 479061</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">sudo</span> perf record --call-graph=dwarf ./exec</span><br></pre></td></tr></table></figure><h2 id="42-ç»“æœå±•ç¤º"><a class="markdownIt-Anchor" href="#42-ç»“æœå±•ç¤º"></a> 4.2 ç»“æœå±•ç¤º</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> perf report -i perf.data --no-inline -g</span><br></pre></td></tr></table></figure><h2 id="43-å¿«æ·é”®"><a class="markdownIt-Anchor" href="#43-å¿«æ·é”®"></a> 4.3 å¿«æ·é”®</h2><ol><li>å±•å¼€ï¼š<code>shift</code> + <code>+</code></li><li></li></ol><h1 id="x-å‚è€ƒ"><a class="markdownIt-Anchor" href="#x-å‚è€ƒ"></a> X å‚è€ƒ</h1><ul><li><a href="https://www.jianshu.com/p/4659063b3c0d"><strong>åŸºäºUbuntu 18.04 å®‰è£…perfå·¥å…·</strong></a></li><li><a href="https://installati.one/install-perf-tools-unstable-ubuntu-22-04/"><strong>How To Install perf-tools-unstable on Ubuntu 22.04</strong></a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-ubuntu-å®‰è£…æ­¥éª¤&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-ubuntu-å®‰è£…æ­¥éª¤&quot;&gt;&lt;/a&gt; 1 ubuntu å®‰è£…æ­¥éª¤&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å®‰è£…&lt;code&gt;linux-tools-common&lt;/c</summary>
      
    
    
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="è°ƒä¼˜" scheme="https://dragonliu2018.github.io/categories/Tool/%E8%B0%83%E4%BC%98/"/>
    
    
  </entry>
  
  <entry>
    <title>[PL][C++] æ€§èƒ½ä¼˜åŒ–æ±‡æ€»</title>
    <link href="https://dragonliu2018.github.io/2025/09/26/PL-C-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%B1%87%E6%80%BB/"/>
    <id>https://dragonliu2018.github.io/2025/09/26/PL-C-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%B1%87%E6%80%BB/</id>
    <published>2025-09-25T16:06:51.000Z</published>
    <updated>2025-09-25T16:20:12.162Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¸¸ç”¨æŠ€å·§"><a class="markdownIt-Anchor" href="#å¸¸ç”¨æŠ€å·§"></a> å¸¸ç”¨æŠ€å·§</h1><ul><li>é¿å…æ„é€ ä¸å¿…è¦çš„å¯¹è±¡ï¼Œä¾‹å¦‚ std::string</li><li>å‡½æ•°è¿”å›å€¼ä¸ºå¸¸é‡å­—ç¬¦ä¸²æ—¶ï¼Œä¸”éœ€è¦ std::string_view ç±»å‹ï¼›å‡½æ•°è¿”å›å€¼ç±»å‹å¯ä»¥è®¾ä¸º std::string_viewï¼Œå¦‚æœè®¾ä¸º std::stringï¼Œä¼šæœ‰å¤šä½™çš„æ‹·è´ã€‚</li></ul><h1 id="åˆ†æ”¯é¢„æµ‹-unlikely"><a class="markdownIt-Anchor" href="#åˆ†æ”¯é¢„æµ‹-unlikely"></a> åˆ†æ”¯é¢„æµ‹ &amp; unlikely</h1><p>refï¼š<a href="https://www.zhihu.com/question/639443238">https://www.zhihu.com/question/639443238</a></p><h1 id="é¿å…åå¤æ„é€ å’Œææ„-vector"><a class="markdownIt-Anchor" href="#é¿å…åå¤æ„é€ å’Œææ„-vector"></a> é¿å…åå¤æ„é€ å’Œææ„ vector</h1><p>ã€çƒ­ç‚¹ã€‘</p><p>é—®é¢˜æ¥æºäº YMatrix å®ä¹ ï¼Œä¸‹é¢çš„ vector å£°æ˜åœ¨äº† for å¾ªç¯å†…éƒ¨ï¼Œæ¯æ¬¡éå†éƒ½ä¼šè¿›è¡Œæ„é€ å’Œææ„ï¼Œæˆæœ¬è¾ƒå¤§ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (std::<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; times; ++i) &#123;</span><br><span class="line">std::vector&lt;std::<span class="type">uint32_t</span>&gt; idx_chain;</span><br><span class="line"><span class="built_in">func</span>(idx_chain);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr /><p>ã€ä¼˜åŒ–ã€‘</p><p>å¯ä»¥å°† vector å£°æ˜ä½ç½®æåˆ° for å¾ªç¯å¤–éƒ¨ï¼Œæ¯æ¬¡éå†å¯¹ vector è¿›è¡Œ clear å³å¯</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">std::vector&lt;std::<span class="type">uint32_t</span>&gt; idx_chain;</span><br><span class="line"><span class="keyword">for</span> (std::<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; times; ++i) &#123;</span><br><span class="line">    idx_chain.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="built_in">func</span>(idx_chain);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="vector-ä½¿ç”¨-reserve-é¿å…é‡å¤å†…å­˜ç”³è¯·ä¸æ•°æ®å¤åˆ¶"><a class="markdownIt-Anchor" href="#vector-ä½¿ç”¨-reserve-é¿å…é‡å¤å†…å­˜ç”³è¯·ä¸æ•°æ®å¤åˆ¶"></a> vector ä½¿ç”¨ reserve é¿å…é‡å¤å†…å­˜ç”³è¯·ä¸æ•°æ®å¤åˆ¶</h1><h2 id="åœºæ™¯ä»‹ç»"><a class="markdownIt-Anchor" href="#åœºæ™¯ä»‹ç»"></a> åœºæ™¯ä»‹ç»</h2><p><strong>å½“ä½¿ç”¨ vector æ—¶ï¼Œå¦‚æœå·²çŸ¥éœ€è¦å¤šå°‘å…ƒç´ çš„ç©ºé—´ï¼Œåˆ™ä½¿ç”¨ <code>reserve</code> å‡½æ•°é¢„å…ˆåˆ†é…è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ï¼Œå‡å°‘åŠ¨æ€å†…å­˜åˆ†é…å’Œå…ƒç´ å¤åˆ¶çš„æ¬¡æ•°</strong>ã€‚è¿™ä½¿å¾—æ’å…¥æ“ä½œæ›´åŠ é«˜æ•ˆï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œæ€§èƒ½ä¼˜åŠ¿æ›´åŠ æ˜æ˜¾ã€‚</p><h2 id="ä»£ç éªŒè¯"><a class="markdownIt-Anchor" href="#ä»£ç éªŒè¯"></a> ä»£ç éªŒè¯</h2><p>ã€<strong>é“¾æ¥</strong>ã€‘<a href="https://quick-bench.com/q/ctDLCeIqzoycLX9KUuBajAapaUA">https://quick-bench.com/q/ctDLCeIqzoycLX9KUuBajAapaUA</a></p><hr /><ul><li><p><strong>ä»£ç </strong></p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> SIZE = <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">vector_push_back_one_by_one</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::vector&lt;std::string&gt; str_vec;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; SIZE; i++) &#123;</span><br><span class="line">        str_vec.<span class="built_in">push_back</span>(std::<span class="built_in">to_string</span>(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">vector_push_back_reserve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::vector&lt;std::string&gt; str_vec;</span><br><span class="line">    str_vec.<span class="built_in">reserve</span>(SIZE);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; SIZE; i++) &#123;</span><br><span class="line">        str_vec.<span class="built_in">push_back</span>(std::<span class="built_in">to_string</span>(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">PushOneByOne</span><span class="params">(benchmark::State&amp; state)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Code inside this loop is measured repeatedly</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> _ : state) &#123;</span><br><span class="line">    <span class="keyword">auto</span> ret = <span class="built_in">vector_push_back_one_by_one</span>();</span><br><span class="line">    <span class="comment">// Make sure the variable is not optimized away by compiler</span></span><br><span class="line">    benchmark::<span class="built_in">DoNotOptimize</span>(ret);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Register the function as a benchmark</span></span><br><span class="line"><span class="built_in">BENCHMARK</span>(PushOneByOne);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">PushReserve</span><span class="params">(benchmark::State&amp; state)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Code before the loop is not measured</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> _ : state) &#123;</span><br><span class="line">    <span class="keyword">auto</span> ret = <span class="built_in">vector_push_back_reserve</span>();</span><br><span class="line">    <span class="comment">// Make sure the variable is not optimized away by compiler</span></span><br><span class="line">    benchmark::<span class="built_in">DoNotOptimize</span>(ret);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">BENCHMARK</span>(PushReserve);</span><br></pre></td></tr></table></figure></li></ul><p><img src="https://raw.githubusercontent.com/Dragonliu2018/hexo-images-bed/main/2025/Snipaste_2025-09-26_00-16-21.png" alt="" /></p><h2 id="gpt-ç°è±¡è§£é‡Š"><a class="markdownIt-Anchor" href="#gpt-ç°è±¡è§£é‡Š"></a> GPT ç°è±¡è§£é‡Š</h2><p><code>vector_push_back_reserve</code> å‡½æ•°æ¯” <code>vector_push_back_one_by_one</code> å‡½æ•°é«˜æ•ˆçš„åŸå› ä¸»è¦åœ¨äºå†…å­˜åˆ†é…ç­–ç•¥çš„ä¸åŒã€‚</p><h3 id="vector_push_back_one_by_one-å‡½æ•°"><a class="markdownIt-Anchor" href="#vector_push_back_one_by_one-å‡½æ•°"></a> <strong><code>vector_push_back_one_by_one</code>Â å‡½æ•°</strong></h3><ul><li><strong>åŠ¨æ€å†…å­˜åˆ†é…</strong>ï¼š<code>std::vector</code> çš„ <code>push_back</code> æ–¹æ³•ä¼šåœ¨å®¹å™¨å®¹é‡ä¸è¶³æ—¶ï¼Œè‡ªåŠ¨åˆ†é…æ–°çš„å†…å­˜æ¥å­˜å‚¨æ›´å¤šçš„å…ƒç´ ã€‚æ¯æ¬¡åˆ†é…çš„å†…å­˜å¤§å°é€šå¸¸æ˜¯å½“å‰å®¹é‡çš„ä¸¤å€å·¦å³ï¼ˆå…·ä½“ç­–ç•¥å› æ ‡å‡†åº“å®ç°è€Œå¼‚ï¼‰ã€‚ä¾‹å¦‚ï¼Œåˆå§‹å®¹é‡å¯èƒ½ä¸º 0ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ <code>push_back</code> æ—¶åˆ†é…ä¸€å®šå¤§å°çš„å†…å­˜ï¼ˆå¦‚ 16 ä¸ªå…ƒç´ çš„ç©ºé—´ï¼‰ï¼Œå½“æ’å…¥ç¬¬ 17 ä¸ªå…ƒç´ æ—¶ï¼Œä¼šé‡æ–°åˆ†é…å†…å­˜ï¼ˆå¦‚ 32 ä¸ªå…ƒç´ çš„ç©ºé—´ï¼‰ï¼Œå¹¶å°†åŸæœ‰å…ƒç´ å¤åˆ¶åˆ°æ–°çš„å†…å­˜ç©ºé—´ä¸­ï¼Œç„¶åé‡Šæ”¾æ—§çš„å†…å­˜ç©ºé—´ã€‚</li><li><strong>å¤šæ¬¡å†…å­˜åˆ†é…å’Œå¤åˆ¶</strong>ï¼šåœ¨æ’å…¥å¤§é‡å…ƒç´ æ—¶ï¼Œè¿™ç§åŠ¨æ€å†…å­˜åˆ†é…ä¼šå¯¼è‡´å¤šæ¬¡å†…å­˜åˆ†é…å’Œå¤åˆ¶æ“ä½œã€‚æ¯æ¬¡é‡æ–°åˆ†é…å†…å­˜æ—¶ï¼Œéƒ½éœ€è¦å°†å·²æœ‰çš„å…ƒç´ å¤åˆ¶åˆ°æ–°çš„å†…å­˜ç©ºé—´ä¸­ï¼Œè¿™ä¼šæ¶ˆè€—å¤§é‡çš„æ—¶é—´å’Œè®¡ç®—èµ„æºã€‚éšç€å…ƒç´ æ•°é‡çš„å¢åŠ ï¼Œè¿™ç§å¼€é”€ä¼šé€æ¸ç´¯ç§¯ï¼Œå¯¼è‡´æ•´ä½“æ€§èƒ½ä¸‹é™ã€‚</li></ul><h3 id="vector_push_back_reserve-å‡½æ•°"><a class="markdownIt-Anchor" href="#vector_push_back_reserve-å‡½æ•°"></a> <strong><code>vector_push_back_reserve</code>Â å‡½æ•°</strong></h3><ul><li><strong>é¢„å…ˆåˆ†é…å†…å­˜</strong>ï¼š<code>std::vector</code> çš„ <code>reserve</code> æ–¹æ³•å…è®¸åœ¨å®¹å™¨åˆ›å»ºæ—¶é¢„å…ˆåˆ†é…è¶³å¤Ÿçš„å†…å­˜æ¥å­˜å‚¨æŒ‡å®šæ•°é‡çš„å…ƒç´ ã€‚åœ¨ <code>vector_push_back_reserve</code> å‡½æ•°ä¸­ï¼Œé€šè¿‡è°ƒç”¨ <code>str_vec.reserve(SIZE)</code>ï¼Œé¢„å…ˆåˆ†é…äº†è¶³å¤Ÿå­˜å‚¨ <code>SIZE</code> ä¸ª <code>std::string</code> å…ƒç´ çš„å†…å­˜ç©ºé—´ã€‚</li><li><strong>å‡å°‘å†…å­˜åˆ†é…å’Œå¤åˆ¶</strong>ï¼šç”±äºé¢„å…ˆåˆ†é…äº†è¶³å¤Ÿçš„å†…å­˜ï¼Œåç»­è°ƒç”¨ <code>push_back</code> æ–¹æ³•æ—¶ï¼Œä¸éœ€è¦å†è¿›è¡ŒåŠ¨æ€å†…å­˜åˆ†é…å’Œå…ƒç´ å¤åˆ¶æ“ä½œã€‚æ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥ç›´æ¥æ’å…¥åˆ°é¢„å…ˆåˆ†é…çš„å†…å­˜ç©ºé—´ä¸­ï¼Œä»è€Œé¿å…äº†å¤šæ¬¡å†…å­˜åˆ†é…å’Œå¤åˆ¶çš„å¼€é”€ï¼Œæ˜¾è‘—æé«˜äº†æ’å…¥æ“ä½œçš„æ•ˆç‡ã€‚</li></ul><h3 id="æ€§èƒ½å¯¹æ¯”"><a class="markdownIt-Anchor" href="#æ€§èƒ½å¯¹æ¯”"></a> <strong>æ€§èƒ½å¯¹æ¯”</strong></h3><ul><li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼š<code>vector_push_back_one_by_one</code> çš„æ—¶é—´å¤æ‚åº¦ä¸º <em>O</em>(<em>n</em>log<em>n</em>)ï¼Œå› ä¸ºæ¯æ¬¡é‡æ–°åˆ†é…å†…å­˜æ—¶ï¼Œéƒ½éœ€è¦å¤åˆ¶å·²æœ‰çš„å…ƒç´ ï¼Œè€Œå¤åˆ¶æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸å½“å‰å…ƒç´ æ•°é‡æˆæ­£æ¯”ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<code>vector_push_back_reserve</code> çš„æ—¶é—´å¤æ‚åº¦ä¸º <em>O</em>(<em>n</em>)ï¼Œå› ä¸ºæ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥ç›´æ¥æ’å…¥åˆ°é¢„å…ˆåˆ†é…çš„å†…å­˜ç©ºé—´ä¸­ï¼Œæ— éœ€é¢å¤–çš„å¤åˆ¶æ“ä½œã€‚</li><li><strong>å®é™…æ€§èƒ½</strong>ï¼šåœ¨å®é™…è¿è¡Œä¸­ï¼Œ<code>vector_push_back_reserve</code> å‡½æ•°çš„æ‰§è¡Œæ—¶é—´é€šå¸¸æ¯” <code>vector_push_back_one_by_one</code> å‡½æ•°çŸ­å¾—å¤šï¼Œå°¤å…¶æ˜¯åœ¨æ’å…¥å¤§é‡å…ƒç´ æ—¶ã€‚è¿™æ˜¯å› ä¸º <code>vector_push_back_one_by_one</code> å‡½æ•°éœ€è¦è¿›è¡Œå¤šæ¬¡å†…å­˜åˆ†é…å’Œå¤åˆ¶æ“ä½œï¼Œè€Œ <code>vector_push_back_reserve</code> å‡½æ•°åªéœ€è¦ä¸€æ¬¡å†…å­˜åˆ†é…ï¼Œåç»­çš„æ’å…¥æ“ä½œéå¸¸é«˜æ•ˆã€‚</li></ul><h1 id="unordered_map-æ›¿æ¢-map"><a class="markdownIt-Anchor" href="#unordered_map-æ›¿æ¢-map"></a> unordered_map æ›¿æ¢ map</h1><h2 id="é—®é¢˜"><a class="markdownIt-Anchor" href="#é—®é¢˜"></a> é—®é¢˜</h2><p>é—®é¢˜æ¥è‡ªä¸ cmu 15-445 fall 2022 p1ï¼Œå½“æ—¶åœ¨çº¿æµ‹è¯•HardTest_4 è¶…æ—¶ï¼ˆä¸Šé™æ˜¯ 10sï¼Œå½“æ—¶ç¨‹åºè€—æ—¶ 14sï¼‰ã€‚</p><h2 id="è°ƒä¼˜"><a class="markdownIt-Anchor" href="#è°ƒä¼˜"></a> è°ƒä¼˜</h2><p>åœ¨ macbook ä¸Šè·‘çš„é¡¹ç›®ï¼Œæ²¡æœ‰ perf åˆ†æå·¥å…·ï¼Œä½¿ç”¨ macos ä¸­çš„ Instruments è¿›è¡Œåˆ†æã€‚</p><p>å¯ä»¥çœ‹åˆ° <code>HardTest_4</code> çš„ä¸»è¦è€—æ—¶åœ¨ <code>HistoryCmpLess()</code> å‡½æ•°ä¸Šï¼š</p><p><img src="https://raw.githubusercontent.com/Dragonliu2018/hexo-images-bed/main/2025/Snipaste_2025-09-26_00-19-21.png" alt="" /></p><p>è€—æ—¶é›†ä¸­åœ¨ä¸‹é¢ä¸‰è¡Œä»£ç ï¼Œæ¨æµ‹æ˜¯ <code>history_</code> çš„éšæœºå–æ•°æ®å¯¼è‡´æ€§èƒ½ä½ä¸‹ã€‚</p><p><img src="https://raw.githubusercontent.com/Dragonliu2018/hexo-images-bed/main/2025/Snipaste_2025-09-26_00-19-41.png" alt="" /></p><p>æŸ¥çœ‹ <code>history_</code> ç±»å‹ï¼Œæœç„¶æ˜¯ map ç±»å‹ï¼Œä½†æ˜¯ä½¿ç”¨ unordered_map æ›´åŠ é«˜æ•ˆã€‚æ›´æ¢æ•°æ®ç±»å‹åï¼Œè€—æ—¶ä¸‹é™åˆ° 7sï¼Œç¬¦åˆé¢„æœŸã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¸¸ç”¨æŠ€å·§&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å¸¸ç”¨æŠ€å·§&quot;&gt;&lt;/a&gt; å¸¸ç”¨æŠ€å·§&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;é¿å…æ„é€ ä¸å¿…è¦çš„å¯¹è±¡ï¼Œä¾‹å¦‚ std::string&lt;/li&gt;
&lt;li&gt;å‡½æ•°è¿”å›å€¼ä¸ºå¸¸é‡å­—ç¬¦ä¸²æ—¶ï¼Œä¸”éœ€è¦ std::str</summary>
      
    
    
    
    <category term="PL" scheme="https://dragonliu2018.github.io/categories/PL/"/>
    
    <category term="C++" scheme="https://dragonliu2018.github.io/categories/PL/C/"/>
    
    
  </entry>
  
  <entry>
    <title>[Tool] docker ä½¿ç”¨æŠ€å·§æ±‡æ€»</title>
    <link href="https://dragonliu2018.github.io/2025/09/25/Tool-docker-%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB/"/>
    <id>https://dragonliu2018.github.io/2025/09/25/Tool-docker-%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB/</id>
    <published>2025-09-25T11:56:32.000Z</published>
    <updated>2025-09-25T16:01:36.310Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¯¼å‡ºå¯¼å…¥é•œåƒ"><a class="markdownIt-Anchor" href="#å¯¼å‡ºå¯¼å…¥é•œåƒ"></a> å¯¼å‡ºå¯¼å…¥é•œåƒ</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯¼å‡ºé•œåƒ</span></span><br><span class="line">docker save -o doris.tar apache/doris:build-env-ldb-toolchain-latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯¼å…¥é•œåƒ</span></span><br><span class="line">docker load -i doris.tar</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¯¼å‡ºå¯¼å…¥é•œåƒ&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å¯¼å‡ºå¯¼å…¥é•œåƒ&quot;&gt;&lt;/a&gt; å¯¼å‡ºå¯¼å…¥é•œåƒ&lt;/h1&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pr</summary>
      
    
    
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="docker" scheme="https://dragonliu2018.github.io/categories/Tool/docker/"/>
    
    
  </entry>
  
  <entry>
    <title>[PL][Python] ç¼–ç¨‹æŠ€å·§æ±‡æ€»</title>
    <link href="https://dragonliu2018.github.io/2025/09/24/PL-Python-%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB/"/>
    <id>https://dragonliu2018.github.io/2025/09/24/PL-Python-%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB/</id>
    <published>2025-09-24T15:47:34.000Z</published>
    <updated>2025-09-24T15:48:11.695Z</updated>
    
    
    
    
    <category term="PL" scheme="https://dragonliu2018.github.io/categories/PL/"/>
    
    <category term="Python" scheme="https://dragonliu2018.github.io/categories/PL/Python/"/>
    
    
  </entry>
  
  <entry>
    <title>[PL][Python] å¸¸è§ bug æ±‡æ€»</title>
    <link href="https://dragonliu2018.github.io/2025/09/24/PL-Python-%E5%B8%B8%E8%A7%81-bug-%E6%B1%87%E6%80%BB/"/>
    <id>https://dragonliu2018.github.io/2025/09/24/PL-Python-%E5%B8%B8%E8%A7%81-bug-%E6%B1%87%E6%80%BB/</id>
    <published>2025-09-24T15:47:16.000Z</published>
    <updated>2025-09-24T15:51:51.209Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sort-sorted"><a class="markdownIt-Anchor" href="#sort-sorted"></a> sort() &amp; sorted()</h1><p>å¯¹æ¯”ä¸¤ä¸ªåˆ—è¡¨æ˜¯å¦å«æœ‰ç›¸åŒçš„å…ƒç´ ï¼Œä¸éœ€è¦é¡ºåºä¸€æ ·ã€‚sort() å‡½æ•°è¿”å› Noneï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ä½¿ç”¨ method-1 è¿›è¡Œåˆ¤æ–­ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># method-1 error</span></span><br><span class="line"><span class="keyword">if</span> l1.sort() == l2.sort():</span><br><span class="line">  xxx</span><br><span class="line"></span><br><span class="line"><span class="comment"># method-2 OK</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">sorted</span>(l1) == <span class="built_in">sorted</span>(l2):</span><br><span class="line">  xxx</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;sort-sorted&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#sort-sorted&quot;&gt;&lt;/a&gt; sort() &amp;amp; sorted()&lt;/h1&gt;
&lt;p&gt;å¯¹æ¯”ä¸¤ä¸ªåˆ—è¡¨æ˜¯å¦å«æœ‰ç›¸åŒçš„å…ƒç´ ï¼Œä¸éœ€è¦é¡ºåºä¸€æ ·ã€‚sort() å‡½æ•°è¿”å›</summary>
      
    
    
    
    <category term="PL" scheme="https://dragonliu2018.github.io/categories/PL/"/>
    
    <category term="Python" scheme="https://dragonliu2018.github.io/categories/PL/Python/"/>
    
    
  </entry>
  
  <entry>
    <title>[Tool] github ä½¿ç”¨æŠ€å·§æ±‡æ€»</title>
    <link href="https://dragonliu2018.github.io/2025/09/24/Tool-github-%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB/"/>
    <id>https://dragonliu2018.github.io/2025/09/24/Tool-github-%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB/</id>
    <published>2025-09-24T14:45:16.000Z</published>
    <updated>2025-09-24T15:43:04.789Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ–°å¢-ssh-å¯†é’¥åˆ°-github-å¸æˆ·"><a class="markdownIt-Anchor" href="#æ–°å¢-ssh-å¯†é’¥åˆ°-github-å¸æˆ·"></a> æ–°å¢ SSH å¯†é’¥åˆ° GitHub å¸æˆ·</h1><ol><li><p>ç”Ÿæˆ keyï¼Œä¸€è·¯é»˜è®¤å³å¯ï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">âœ  .ssh ssh-keygen</span><br></pre></td></tr></table></figure></li><li><p>å¤åˆ¶ id_rsa.pub æ–‡ä»¶ä¸­çš„å†…å®¹åˆ° GitHubï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">âœ  .ssh cat id_rsa.pub</span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸï¼š</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">âœ  .ssh ssh -T git@github.com</span><br><span class="line">Hi Dragonliu2018! You&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ–°å¢-ssh-å¯†é’¥åˆ°-github-å¸æˆ·&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#æ–°å¢-ssh-å¯†é’¥åˆ°-github-å¸æˆ·&quot;&gt;&lt;/a&gt; æ–°å¢ SSH å¯†é’¥åˆ° GitHub å¸æˆ·&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç”Ÿæˆ keyï¼Œä¸€</summary>
      
    
    
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="git" scheme="https://dragonliu2018.github.io/categories/Tool/git/"/>
    
    
  </entry>
  
  <entry>
    <title>[Tool] git æŠ¥é”™æ±‡æ€»</title>
    <link href="https://dragonliu2018.github.io/2025/09/24/Tool-git-%E6%8A%A5%E9%94%99%E6%B1%87%E6%80%BB/"/>
    <id>https://dragonliu2018.github.io/2025/09/24/Tool-git-%E6%8A%A5%E9%94%99%E6%B1%87%E6%80%BB/</id>
    <published>2025-09-24T14:44:11.000Z</published>
    <updated>2025-09-24T15:43:06.611Z</updated>
    
    <content type="html"><![CDATA[<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#&quot;&gt;&lt;/a&gt; &lt;/h1&gt;
</summary>
      
    
    
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="git" scheme="https://dragonliu2018.github.io/categories/Tool/git/"/>
    
    
  </entry>
  
  <entry>
    <title>[Tool] git ä½¿ç”¨æŠ€å·§æ±‡æ€»</title>
    <link href="https://dragonliu2018.github.io/2025/09/24/Tool-git-%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB/"/>
    <id>https://dragonliu2018.github.io/2025/09/24/Tool-git-%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7%E6%B1%87%E6%80%BB/</id>
    <published>2025-09-24T14:21:50.000Z</published>
    <updated>2025-09-25T16:01:36.310Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å°†å½“å‰ä¿®æ”¹å‹åˆ°-head-commit"><a class="markdownIt-Anchor" href="#å°†å½“å‰ä¿®æ”¹å‹åˆ°-head-commit"></a> å°†å½“å‰ä¿®æ”¹å‹åˆ° HEAD commit</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git commit --amend</span><br></pre></td></tr></table></figure><h1 id="å–æ¶ˆæŸä¸ªæ–‡ä»¶çš„æ›´æ”¹"><a class="markdownIt-Anchor" href="#å–æ¶ˆæŸä¸ªæ–‡ä»¶çš„æ›´æ”¹"></a> å–æ¶ˆæŸä¸ªæ–‡ä»¶çš„æ›´æ”¹</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git checkout -- &lt;file_name&gt;</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_32907195/article/details/115333898">https://blog.csdn.net/qq_32907195/article/details/115333898</a></p></blockquote><h1 id="åˆ é™¤æŸä¸ªæ–‡ä»¶å¤¹"><a class="markdownIt-Anchor" href="#åˆ é™¤æŸä¸ªæ–‡ä»¶å¤¹"></a> åˆ é™¤æŸä¸ªæ–‡ä»¶(å¤¹)</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¨è</span></span><br><span class="line">git rm &lt;file_name&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç›¸å½“äº</span></span><br><span class="line">rm &lt;file_name&gt;</span><br><span class="line">git add &lt;file_name&gt;</span><br></pre></td></tr></table></figure><h1 id="ignore-å·²ç»-push-åˆ°è¿œç«¯çš„æ–‡ä»¶"><a class="markdownIt-Anchor" href="#ignore-å·²ç»-push-åˆ°è¿œç«¯çš„æ–‡ä»¶"></a> ignore å·²ç» push åˆ°è¿œç«¯çš„æ–‡ä»¶</h1><p>ã€<strong>é—®é¢˜</strong>ã€‘</p><p>.vscode æ–‡ä»¶å¤¹å·²ç» push åˆ°è¿œç¨‹ï¼Œå¦‚ä½• ignoreï¼Ÿ</p><hr /><p>ã€<strong>è§£å†³</strong>ã€‘</p><ol><li><p>ä» Git ç´¢å¼•ä¸­ç§»é™¤ .vscode ç›®å½•ï¼ˆä¸ä¼šåˆ é™¤æœ¬åœ°æ–‡ä»¶å¤¹ï¼Œåªæ˜¯è®© git ä¸å†è·Ÿè¸ªå®ƒï¼‰ï¼š</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  SG-DQA git:(main) git <span class="built_in">rm</span> -r --cached .vscode</span><br><span class="line"><span class="built_in">rm</span> <span class="string">&#x27;.vscode/launch.json&#x27;</span></span><br><span class="line"><span class="built_in">rm</span> <span class="string">&#x27;.vscode/settings.json&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ  <code>.gitignore</code> æ–‡ä»¶</p> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.vscode/</span><br></pre></td></tr></table></figure></li><li><p>git add &amp; git commit &amp; git push</p></li></ol><h1 id="åˆå¹¶å¤šä¸ª-commit"><a class="markdownIt-Anchor" href="#åˆå¹¶å¤šä¸ª-commit"></a> åˆå¹¶å¤šä¸ª commit</h1><p><img src="https://raw.githubusercontent.com/Dragonliu2018/hexo-images-bed/main/2025/Snipaste_2025-09-24_23-13-21.png" alt="" /></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">method-1</span></span><br><span class="line">git rebase -i origin/main</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">method-2</span></span><br><span class="line">git rebase -i ce75153a87</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">method-3: ä¸è¦åˆå¹¶çš„commitæ•°é‡ä¸€è‡´</span></span><br><span class="line">git rebase -i HEAD~8</span><br></pre></td></tr></table></figure><h1 id="patch"><a class="markdownIt-Anchor" href="#patch"></a> patch</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git diff &gt; xx.patch</span><br><span class="line">git apply x.patch</span><br></pre></td></tr></table></figure><h1 id="æœ¬åœ°åˆ†æ”¯-è¿œç¨‹åˆ†æ”¯"><a class="markdownIt-Anchor" href="#æœ¬åœ°åˆ†æ”¯-è¿œç¨‹åˆ†æ”¯"></a> æœ¬åœ°åˆ†æ”¯ &amp; è¿œç¨‹åˆ†æ”¯</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯å…³è”ï¼ˆè·Ÿè¸ªï¼‰çš„è¿œç¨‹åˆ†æ”¯ä¹‹é—´çš„å¯¹åº”å…³ç³»</span></span><br><span class="line">git branch -vv</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ï¼ˆæ²¡æœ‰å¯¹åº”åˆ†æ”¯ï¼‰</span></span><br><span class="line">git push -f --set-upstream origin dragonliu/dictionary_mysql_opt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„å…³è”</span></span><br><span class="line">git branch --set-upstream-to=origin/&lt;è¿œç¨‹åˆ†æ”¯å&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="åˆ é™¤åˆ†æ”¯"><a class="markdownIt-Anchor" href="#åˆ é™¤åˆ†æ”¯"></a> åˆ é™¤åˆ†æ”¯</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git branch -D fix/authentication</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"> git push origin --delete fix/authentication</span><br></pre></td></tr></table></figure><h1 id="æ’¤é”€-commit"><a class="markdownIt-Anchor" href="#æ’¤é”€-commit"></a> æ’¤é”€ commit</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ’¤é”€æœ¬åœ° commit</span></span><br><span class="line">git reset --soft HEAD^</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ’¤é”€è¿œç¨‹ commit</span></span><br><span class="line">git reset HEAD^</span><br><span class="line">git push -f</span><br></pre></td></tr></table></figure><h1 id="ä¿®æ”¹è¿œç¨‹ä»“åº“é“¾æ¥"><a class="markdownIt-Anchor" href="#ä¿®æ”¹è¿œç¨‹ä»“åº“é“¾æ¥"></a> ä¿®æ”¹è¿œç¨‹ä»“åº“é“¾æ¥</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git remote set-url origin git@github.com:Dragonliu2018/doris.git</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å°†å½“å‰ä¿®æ”¹å‹åˆ°-head-commit&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#å°†å½“å‰ä¿®æ”¹å‹åˆ°-head-commit&quot;&gt;&lt;/a&gt; å°†å½“å‰ä¿®æ”¹å‹åˆ° HEAD commit&lt;/h1&gt;
&lt;figure class=&quot;highlight</summary>
      
    
    
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="git" scheme="https://dragonliu2018.github.io/categories/Tool/git/"/>
    
    
  </entry>
  
  <entry>
    <title>[Tool] wsl æŠ¥é”™æ±‡æ€»</title>
    <link href="https://dragonliu2018.github.io/2025/09/24/Tool-wsl-%E6%8A%A5%E9%94%99%E6%B1%87%E6%80%BB/"/>
    <id>https://dragonliu2018.github.io/2025/09/24/Tool-wsl-%E6%8A%A5%E9%94%99%E6%B1%87%E6%80%BB/</id>
    <published>2025-09-24T14:08:37.000Z</published>
    <updated>2025-09-24T14:12:11.127Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ‰§è¡Œ-systemctl-å¤±è´¥"><a class="markdownIt-Anchor" href="#æ‰§è¡Œ-systemctl-å¤±è´¥"></a> æ‰§è¡Œ systemctl å¤±è´¥</h1><p>ã€<strong>é—®é¢˜</strong>ã€‘</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">System has not been booted with systemd as init system (PID 1). Can&#x27;t operate. Failed to connect to bus: Host is down</span><br></pre></td></tr></table></figure><hr /><p>ã€<strong>è§£å†³</strong>ã€‘</p><p><a href="https://github.com/microsoft/WSL/issues/8883">https://github.com/microsoft/WSL/issues/8883</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ‰§è¡Œ-systemctl-å¤±è´¥&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#æ‰§è¡Œ-systemctl-å¤±è´¥&quot;&gt;&lt;/a&gt; æ‰§è¡Œ systemctl å¤±è´¥&lt;/h1&gt;
&lt;p&gt;ã€&lt;strong&gt;é—®é¢˜&lt;/strong&gt;ã€‘&lt;/p&gt;
&lt;figure</summary>
      
    
    
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="wsl" scheme="https://dragonliu2018.github.io/categories/Tool/wsl/"/>
    
    
  </entry>
  
  <entry>
    <title>[databend] pivot æ”¯æŒ subquery</title>
    <link href="https://dragonliu2018.github.io/2025/09/14/databend-pivot-%E6%94%AF%E6%8C%81-subquery/"/>
    <id>https://dragonliu2018.github.io/2025/09/14/databend-pivot-%E6%94%AF%E6%8C%81-subquery/</id>
    <published>2025-09-14T09:45:42.000Z</published>
    <updated>2025-09-23T01:06:58.364Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-ä»»åŠ¡èƒŒæ™¯"><a class="markdownIt-Anchor" href="#1-ä»»åŠ¡èƒŒæ™¯"></a> 1 ä»»åŠ¡èƒŒæ™¯</h1><ul><li><strong>Issue</strong>ï¼š<a href="https://github.com/databendlabs/databend/issues/16556">https://github.com/databendlabs/databend/issues/16556</a></li><li><strong>PR</strong>ï¼š<a href="https://github.com/databendlabs/databend/pull/16631">https://github.com/databendlabs/databend/pull/16631</a></li></ul><h2 id="11-ä»»åŠ¡ä»‹ç»"><a class="markdownIt-Anchor" href="#11-ä»»åŠ¡ä»‹ç»"></a> 1.1 ä»»åŠ¡ä»‹ç»</h2><p><strong>ç›®å‰ databend ä¸­çš„ pivot å’Œ unpivot ä¸æ”¯æŒ <code>FROM/IN + subquery</code></strong>ã€‚â†’ <a href="https://docs.databend.com/sql/sql-commands/query-syntax/query-pivot">æ–‡æ¡£é“¾æ¥</a></p><p><strong>è¦æ±‚å®ç°ç±»ä¼¼äº snowflake çš„è¯­æ³•ï¼Œä¹Ÿå°±æ˜¯è®© pivot æ”¯æŒ <code>FROM/IN + subquery</code>ï¼Œunpivot æ”¯æŒ <code>FROM + subquery</code></strong>ã€‚â†’ <a href="https://docs.snowflake.com/en/sql-reference/constructs/pivot">æ–‡æ¡£é“¾æ¥</a></p><ul><li><p><strong>databend PIVOT è¯­æ³•</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ...</span><br><span class="line"><span class="keyword">FROM</span> ...</span><br><span class="line">   PIVOT ( <span class="operator">&lt;</span>aggregate_function<span class="operator">&gt;</span> ( <span class="operator">&lt;</span>pivot_column<span class="operator">&gt;</span> )</span><br><span class="line">            <span class="keyword">FOR</span> <span class="operator">&lt;</span>value_column<span class="operator">&gt;</span> <span class="keyword">IN</span> ( <span class="operator">&lt;</span>pivot_value_1<span class="operator">&gt;</span> [ , <span class="operator">&lt;</span>pivot_value_2<span class="operator">&gt;</span> ... ] ) )</span><br><span class="line"></span><br><span class="line">[ ... ]</span><br></pre></td></tr></table></figure><ul><li><code>&lt;aggregate_function&gt;</code>ï¼šç”¨äºç»„åˆæ¥è‡ª<code>pivot_column</code>çš„åˆ†ç»„å€¼çš„èšåˆå‡½æ•°ã€‚</li><li><code>&lt;pivot_column&gt;</code>ï¼šå°†ä½¿ç”¨æŒ‡å®šçš„<code>&lt;aggregate_function&gt;</code>è¿›è¡Œèšåˆçš„åˆ—ã€‚</li><li><code>&lt;value_column&gt;</code>ï¼šå…¶å”¯ä¸€å€¼å°†åœ¨æ—‹è½¬ç»“æœé›†ä¸­æˆä¸ºæ–°åˆ—çš„åˆ—ã€‚</li><li><code>&lt;pivot_value_N&gt;</code>ï¼šæ¥è‡ª<code>&lt;value_column&gt;</code>çš„å”¯ä¸€å€¼ï¼Œå°†åœ¨æ—‹è½¬ç»“æœé›†ä¸­æˆä¸ºæ–°åˆ—ã€‚</li></ul></li><li><p><strong>databend UNPIVOT è¯­æ³•</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ...</span><br><span class="line"><span class="keyword">FROM</span> ...</span><br><span class="line">    UNPIVOT ( <span class="operator">&lt;</span>value_column<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">FOR</span> <span class="operator">&lt;</span>name_column<span class="operator">&gt;</span> <span class="keyword">IN</span> ( <span class="operator">&lt;</span>column_list<span class="operator">&gt;</span> ) )</span><br><span class="line"></span><br><span class="line">[ ... ]</span><br></pre></td></tr></table></figure><ul><li><code>&lt;value_column&gt;</code>ï¼šå°†å­˜å‚¨ä»Â <code>&lt;column_list&gt;</code>Â ä¸­åˆ—å‡ºçš„åˆ—ä¸­æå–çš„å€¼çš„åˆ—ã€‚</li><li><code>&lt;name_column&gt;</code>ï¼šå°†å­˜å‚¨ä»ä¸­æå–å€¼çš„åˆ—çš„åç§°çš„åˆ—ã€‚</li><li><code>&lt;column_list&gt;</code>ï¼šè¦å–æ¶ˆé€è§†çš„åˆ—çš„åˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”ã€‚</li></ul></li><li><p><strong>snowflake PIVOT è¯­æ³•</strong></p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ...</span><br><span class="line"><span class="keyword">FROM</span> ...</span><br><span class="line">   PIVOT ( <span class="operator">&lt;</span>aggregate_function<span class="operator">&gt;</span> ( <span class="operator">&lt;</span>pivot_column<span class="operator">&gt;</span> )</span><br><span class="line">            <span class="keyword">FOR</span> <span class="operator">&lt;</span>value_column<span class="operator">&gt;</span> <span class="keyword">IN</span> (</span><br><span class="line">              <span class="operator">&lt;</span>pivot_value_1<span class="operator">&gt;</span> [ , <span class="operator">&lt;</span>pivot_value_2<span class="operator">&gt;</span> ... ]</span><br><span class="line">              <span class="operator">|</span> <span class="keyword">ANY</span> [ <span class="keyword">ORDER</span> <span class="keyword">BY</span> ... ]</span><br><span class="line">              <span class="operator">|</span> <span class="operator">&lt;</span>subquery<span class="operator">&gt;</span></span><br><span class="line">            )</span><br><span class="line">            [ <span class="keyword">DEFAULT</span> <span class="keyword">ON</span> <span class="keyword">NULL</span> (<span class="operator">&lt;</span><span class="keyword">value</span><span class="operator">&gt;</span>) ]</span><br><span class="line">         )</span><br><span class="line"></span><br><span class="line">[ ... ]</span><br></pre></td></tr></table></figure></li><li><p><strong>snowflake UNPIVOT è¯­æ³•</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ...</span><br><span class="line"><span class="keyword">FROM</span> ...</span><br><span class="line">    UNPIVOT [ &#123; INCLUDE <span class="operator">|</span> EXCLUDE &#125; NULLS ]</span><br><span class="line">      ( <span class="operator">&lt;</span>value_column<span class="operator">&gt;</span></span><br><span class="line">        <span class="keyword">FOR</span> <span class="operator">&lt;</span>name_column<span class="operator">&gt;</span> <span class="keyword">IN</span> ( <span class="operator">&lt;</span>column_list<span class="operator">&gt;</span> ) )</span><br><span class="line"></span><br><span class="line">[ ... ]</span><br></pre></td></tr></table></figure></li></ul><h2 id="12-ä»‹ç»-pivot-unpivot"><a class="markdownIt-Anchor" href="#12-ä»‹ç»-pivot-unpivot"></a> 1.2 ä»‹ç» pivot &amp; unpivot</h2><h3 id="121-pivoté€è§†ä¸€åˆ—ä¸­çš„å±æ€§å€¼è½¬æˆå¤šä¸ªå¯¹åº”å±æ€§"><a class="markdownIt-Anchor" href="#121-pivoté€è§†ä¸€åˆ—ä¸­çš„å±æ€§å€¼è½¬æˆå¤šä¸ªå¯¹åº”å±æ€§"></a> 1.2.1 <strong>pivotï¼ˆé€è§†ï¼Œä¸€åˆ—ä¸­çš„å±æ€§å€¼è½¬æˆå¤šä¸ªå¯¹åº”å±æ€§ï¼‰</strong></h3><blockquote><p><a href="https://docs.databend.com/sql/sql-commands/query-syntax/query-pivot">https://docs.databend.com/sql/sql-commands/query-syntax/query-pivot</a></p></blockquote><hr /><p><strong><code>PIVOT</code>æ“ä½œé€šè¿‡æ—‹è½¬è¡¨æ ¼å¹¶åŸºäºæŒ‡å®šåˆ—èšåˆç»“æœæ¥è½¬æ¢è¡¨æ ¼</strong>ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯¹äºæ€»ç»“å’Œåˆ†æå¤§é‡æ•°æ®ä»¥æ›´å¯è¯»æ ¼å¼æ˜¾ç¤ºéå¸¸æœ‰ç”¨çš„æ“ä½œã€‚</p><hr /><ul><li><p><strong>databend PIVOT è¯­æ³•</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ...</span><br><span class="line"><span class="keyword">FROM</span> ...</span><br><span class="line">   PIVOT ( <span class="operator">&lt;</span>aggregate_function<span class="operator">&gt;</span> ( <span class="operator">&lt;</span>pivot_column<span class="operator">&gt;</span> )</span><br><span class="line">            <span class="keyword">FOR</span> <span class="operator">&lt;</span>value_column<span class="operator">&gt;</span> <span class="keyword">IN</span> ( <span class="operator">&lt;</span>pivot_value_1<span class="operator">&gt;</span> [ , <span class="operator">&lt;</span>pivot_value_2<span class="operator">&gt;</span> ... ] ) )</span><br><span class="line"></span><br><span class="line">[ ... ]</span><br></pre></td></tr></table></figure><ul><li><code>&lt;aggregate_function&gt;</code>ï¼šç”¨äºç»„åˆæ¥è‡ª<code>pivot_column</code>çš„åˆ†ç»„å€¼çš„èšåˆå‡½æ•°ã€‚</li><li><code>&lt;pivot_column&gt;</code>ï¼šå°†ä½¿ç”¨æŒ‡å®šçš„<code>&lt;aggregate_function&gt;</code>è¿›è¡Œèšåˆçš„åˆ—ã€‚</li><li><code>&lt;value_column&gt;</code>ï¼šå…¶å”¯ä¸€å€¼å°†åœ¨æ—‹è½¬ç»“æœé›†ä¸­æˆä¸ºæ–°åˆ—çš„åˆ—ã€‚</li><li><code>&lt;pivot_value_N&gt;</code>ï¼šæ¥è‡ª<code>&lt;value_column&gt;</code>çš„å”¯ä¸€å€¼ï¼Œå°†åœ¨æ—‹è½¬ç»“æœé›†ä¸­æˆä¸ºæ–°åˆ—ã€‚</li></ul></li></ul><hr /><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º monthly_sales çš„è¡¨ï¼Œå…¶ä¸­<strong>åŒ…å«ä¸åŒå‘˜å·¥åœ¨ä¸åŒæœˆä»½çš„é”€å”®æ•°æ®</strong>ã€‚æˆ‘ä»¬<strong>å¯ä»¥ä½¿ç”¨<code>PIVOT</code>æ“ä½œæ¥æ€»ç»“æ•°æ®å¹¶è®¡ç®—æ¯ä¸ªå‘˜å·¥åœ¨æ¯ä¸ªæœˆçš„æ€»é”€å”®é¢</strong>ã€‚</p><ul><li><p><strong>åˆ›å»ºå’Œæ’å…¥æ•°æ®</strong></p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºmonthly_salesè¡¨</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> monthly_sales(</span><br><span class="line">  empid <span class="type">INT</span>,</span><br><span class="line">  amount <span class="type">INT</span>,</span><br><span class="line">  <span class="keyword">month</span> <span class="type">VARCHAR</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥é”€å”®æ•°æ®</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> monthly_sales <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="number">1</span>, <span class="number">10000</span>, <span class="string">&#x27;JAN&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">400</span>, <span class="string">&#x27;JAN&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">4500</span>, <span class="string">&#x27;JAN&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">35000</span>, <span class="string">&#x27;JAN&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">5000</span>, <span class="string">&#x27;FEB&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">3000</span>, <span class="string">&#x27;FEB&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">200</span>, <span class="string">&#x27;FEB&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">90500</span>, <span class="string">&#x27;FEB&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">6000</span>, <span class="string">&#x27;MAR&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">5000</span>, <span class="string">&#x27;MAR&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">2500</span>, <span class="string">&#x27;MAR&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">9500</span>, <span class="string">&#x27;MAR&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">8000</span>, <span class="string">&#x27;APR&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">10000</span>, <span class="string">&#x27;APR&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">800</span>, <span class="string">&#x27;APR&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">4500</span>, <span class="string">&#x27;APR&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨ PIVOT</strong></p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>PIVOT</code>æ“ä½œæ¥è®¡ç®—æ¯ä¸ªå‘˜å·¥åœ¨æ¯ä¸ªæœˆçš„æ€»é”€å”®é¢ã€‚æˆ‘ä»¬å°†ä½¿ç”¨<code>SUM</code>èšåˆå‡½æ•°æ¥è®¡ç®—æ€»é”€å”®é¢ï¼Œ<strong>MONTH åˆ—å°†è¢«æ—‹è½¬ä»¥ä¸ºæ¯ä¸ªæœˆåˆ›å»ºæ–°åˆ—ã€‚</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> monthly_sales</span><br><span class="line">PIVOT(<span class="built_in">SUM</span>(amount) <span class="keyword">FOR</span> <span class="keyword">MONTH</span> <span class="keyword">IN</span> (<span class="string">&#x27;JAN&#x27;</span>, <span class="string">&#x27;FEB&#x27;</span>, <span class="string">&#x27;MAR&#x27;</span>, <span class="string">&#x27;APR&#x27;</span>))</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> EMPID;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------+-------+-------+-------+-------+</span></span><br><span class="line"><span class="operator">|</span> empid <span class="operator">|</span> jan   <span class="operator">|</span> feb   <span class="operator">|</span> mar   <span class="operator">|</span> apr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+-------+-------+-------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> <span class="number">10400</span> <span class="operator">|</span>  <span class="number">8000</span> <span class="operator">|</span> <span class="number">11000</span> <span class="operator">|</span> <span class="number">18000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> <span class="number">39500</span> <span class="operator">|</span> <span class="number">90700</span> <span class="operator">|</span> <span class="number">12000</span> <span class="operator">|</span>  <span class="number">5300</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+-------+-------+-------+</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="122-unpivotå–æ¶ˆé€è§†å¤šä¸ªå±æ€§è½¬æˆä¸€åˆ—ä¸­å¯¹åº”çš„å±æ€§å€¼"><a class="markdownIt-Anchor" href="#122-unpivotå–æ¶ˆé€è§†å¤šä¸ªå±æ€§è½¬æˆä¸€åˆ—ä¸­å¯¹åº”çš„å±æ€§å€¼"></a> 1.2.2 <strong>unpivotï¼ˆå–æ¶ˆé€è§†ï¼Œå¤šä¸ªå±æ€§è½¬æˆä¸€åˆ—ä¸­å¯¹åº”çš„å±æ€§å€¼ï¼‰</strong></h3><blockquote><p><a href="https://docs.databend.com/sql/sql-commands/query-syntax/query-unpivot">https://docs.databend.com/sql/sql-commands/query-syntax/query-unpivot</a></p></blockquote><hr /><p><code>UNPIVOT</code>Â æ“ä½œé€šè¿‡å°†åˆ—è½¬æ¢ä¸ºè¡Œæ¥æ—‹è½¬è¡¨ã€‚å®ƒæ˜¯ä¸€ä¸ªå…³ç³»æ“ä½œç¬¦ï¼Œæ¥å—ä¸¤åˆ—ï¼ˆæ¥è‡ªè¡¨æˆ–å­æŸ¥è¯¢ï¼‰ï¼Œä»¥åŠåˆ—çš„åˆ—è¡¨ï¼Œå¹¶ä¸ºåˆ—è¡¨ä¸­æŒ‡å®šçš„æ¯åˆ—ç”Ÿæˆä¸€è¡Œã€‚åœ¨æŸ¥è¯¢ä¸­ï¼Œå®ƒåœ¨ FROM å­å¥ä¸­æŒ‡å®šï¼Œä½äºè¡¨åæˆ–å­æŸ¥è¯¢ä¹‹åã€‚</p><hr /><ul><li><p><strong>databend UNPIVOT è¯­æ³•</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ...</span><br><span class="line"><span class="keyword">FROM</span> ...</span><br><span class="line">    UNPIVOT ( <span class="operator">&lt;</span>value_column<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">FOR</span> <span class="operator">&lt;</span>name_column<span class="operator">&gt;</span> <span class="keyword">IN</span> ( <span class="operator">&lt;</span>column_list<span class="operator">&gt;</span> ) )</span><br><span class="line"></span><br><span class="line">[ ... ]</span><br></pre></td></tr></table></figure><ul><li><code>&lt;value_column&gt;</code>ï¼šå°†å­˜å‚¨ä»Â <code>&lt;column_list&gt;</code>Â ä¸­åˆ—å‡ºçš„åˆ—ä¸­æå–çš„å€¼çš„åˆ—ã€‚</li><li><code>&lt;name_column&gt;</code>ï¼šå°†å­˜å‚¨ä»ä¸­æå–å€¼çš„åˆ—çš„åç§°çš„åˆ—ã€‚</li><li><code>&lt;column_list&gt;</code>ï¼šè¦å–æ¶ˆé€è§†çš„åˆ—çš„åˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”ã€‚</li></ul></li></ul><hr /><p>è®©æˆ‘ä»¬å–æ¶ˆé€è§†ä¸ªåˆ«æœˆä»½åˆ—ï¼Œä»¥è¿”å›æ¯ä½å‘˜å·¥æ¯æœˆçš„å•ä¸€é”€å”®å€¼ï¼š</p><ul><li><p><strong>åˆ›å»ºå’Œæ’å…¥æ•°æ®</strong></p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»º unpivoted_monthly_sales è¡¨</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> unpivoted_monthly_sales(</span><br><span class="line">  empid <span class="type">INT</span>,</span><br><span class="line">  jan <span class="type">INT</span>,</span><br><span class="line">  feb <span class="type">INT</span>,</span><br><span class="line">  mar <span class="type">INT</span>,</span><br><span class="line">  apr <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥é”€å”®æ•°æ®</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> unpivoted_monthly_sales <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="number">1</span>, <span class="number">10400</span>,  <span class="number">8000</span>, <span class="number">11000</span>, <span class="number">18000</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">39500</span>, <span class="number">90700</span>, <span class="number">12000</span>,  <span class="number">5300</span>);</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨ UNPIVOT</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> unpivoted_monthly_sales</span><br><span class="line">    UNPIVOT (amount</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">month</span> <span class="keyword">IN</span> (jan, feb, mar, apr));</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------+-------+--------+</span></span><br><span class="line"><span class="operator">|</span> empid <span class="operator">|</span> <span class="keyword">month</span> <span class="operator">|</span> amount <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+--------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> jan   <span class="operator">|</span>  <span class="number">10400</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> feb   <span class="operator">|</span>   <span class="number">8000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> mar   <span class="operator">|</span>  <span class="number">11000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> apr   <span class="operator">|</span>  <span class="number">18000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> jan   <span class="operator">|</span>  <span class="number">39500</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> feb   <span class="operator">|</span>  <span class="number">90700</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> mar   <span class="operator">|</span>  <span class="number">12000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> apr   <span class="operator">|</span>   <span class="number">5300</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+--------+</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="2-è®¾è®¡å‚è€ƒç«å“åˆ†æ"><a class="markdownIt-Anchor" href="#2-è®¾è®¡å‚è€ƒç«å“åˆ†æ"></a> 2 è®¾è®¡å‚è€ƒï¼ˆç«å“åˆ†æï¼‰</h1><h1 id="3-æ€è·¯ä¸å®ç°"><a class="markdownIt-Anchor" href="#3-æ€è·¯ä¸å®ç°"></a> 3 æ€è·¯ä¸å®ç°</h1><h2 id="31-æ€è·¯"><a class="markdownIt-Anchor" href="#31-æ€è·¯"></a> 3.1 æ€è·¯</h2><p>å®ç° <code>from + subquery</code> è¾ƒä¸ºç®€å•ï¼Œåœ¨ TableReference::Subquery åŠ ä¸Š pivot å’Œ unpivot å­—æ®µï¼Œä¿®æ”¹ parser åŠå…¶ä»–ç›¸å…³åœ°æ–¹ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">subquery</span> = <span class="title function_ invoke__">map</span>(</span><br><span class="line">    rule! &#123;</span><br><span class="line">        LATERAL? ~ <span class="string">&quot;(&quot;</span> ~ #query ~ <span class="string">&quot;)&quot;</span> ~ #table_alias? ~ #pivot? ~ #unpivot?</span><br><span class="line">    &#125;,</span><br><span class="line">    |(lateral, _, subquery, _, alias, pivot, unpivot)| TableReferenceElement::Subquery &#123;</span><br><span class="line">        lateral: lateral.<span class="title function_ invoke__">is_some</span>(),</span><br><span class="line">        subquery: <span class="type">Box</span>::<span class="title function_ invoke__">new</span>(subquery),</span><br><span class="line">        alias,</span><br><span class="line">        pivot: pivot.<span class="title function_ invoke__">map</span>(<span class="type">Box</span>::new),</span><br><span class="line">        unpivot: unpivot.<span class="title function_ invoke__">map</span>(<span class="type">Box</span>::new),</span><br><span class="line">    &#125;,</span><br><span class="line">);</span><br></pre></td></tr></table></figure><hr /><p>å®ç° <code>in + subquery</code> ç›¸å¯¹å¤æ‚ï¼Œå› ä¸ºåœ¨ binder çš„æ—¶å€™å¿…é¡»çŸ¥é“ column çš„ name æ‰èƒ½ç”Ÿæˆé€»è¾‘è®¡åˆ’ï¼Œæ‰€ä»¥åªèƒ½å…ˆæ‰§è¡Œä¸€ä¸‹è¿™ä¸ª subquery ï¼Œç„¶åæŠŠè¿”å›å€¼å½“ä½œ values å¤„ç†ï¼›ä½†æ˜¯æ‰§è¡Œ query/plan æ˜¯åœ¨ service æ¨¡å—ä¸‹ï¼Œbinder æ˜¯åœ¨ sql æ¨¡å—ï¼Œå­˜åœ¨å¾ªç¯è°ƒç”¨çš„é—®é¢˜ã€‚â†’ <a href="https://www.notion.so/125e3d1c52c6806ca52dedaa716ef5ae?pvs=21">è§£å†³å¾ªç¯ä¾èµ–é—®é¢˜</a></p><p>è§£å†³æ€è·¯æœ‰ä¸‰ç§ï¼š</p><ol><li>ã€<strong>æ€è·¯-1</strong>ã€‘åœ¨ pivot_rewrite é˜¶æ®µï¼ˆbinderï¼‰æ‰§è¡Œ Subquery å¾—åˆ°ç­”æ¡ˆï¼Œå‚è€ƒ QuerySampleExecutor å†™ä¸ªå›è°ƒå‡½æ•°åœ¨ binder é‡Œé¢è°ƒä¸€ä¸‹ service çš„å‡½æ•°æ‰§è¡Œã€‚<ol><li><p>Pivot ç»“æ„ä½“æ–°æ·» Subquery å­—æ®µï¼ˆQueryï¼‰ï¼Œç”¨äºå­˜å‚¨ <code>in + subquery</code> ä¸­çš„ subqueryï¼›</p><ul><li><p><strong>Pivot</strong></p>  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸç‰ˆ</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">struct</span> <span class="title class_">Pivot</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> aggregate: Expr,</span><br><span class="line">    <span class="keyword">pub</span> value_column: Identifier,</span><br><span class="line">    <span class="keyword">pub</span> values: <span class="type">Vec</span>&lt;Expr&gt;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹å</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">PivotValues</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">ColumnValues</span>(<span class="type">Vec</span>&lt;Expr&gt;),</span><br><span class="line">    <span class="title function_ invoke__">Subquery</span>(<span class="type">Box</span>&lt;Query&gt;),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">struct</span> <span class="title class_">Pivot</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> aggregate: Expr,</span><br><span class="line">    <span class="keyword">pub</span> value_column: Identifier,</span><br><span class="line">    <span class="keyword">pub</span> values: PivotValues,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>åœ¨ rewrite_pivot å‡½æ•°ä¸­å¯¹ Subquery è¿›è¡Œ parser + rewrite + opt + exec ç­‰æ“ä½œï¼Œå¹¶å°†ç»“æœå­˜åœ¨åŸæ¥çš„ <code>values</code> å­—æ®µï¼Œåç»­æ“ä½œä¸€è‡´ã€‚</p><ol><li>æ‰§è¡Œ query çš„å›è°ƒå‡½æ•°ç›®å‰æœ‰åŸºäº PhysicalPlan çš„ï¼Œä¸€ç§æ–¹æ¡ˆæ˜¯åŸºäºè¯¥å‡½æ•°è¿›è¡Œæ“ä½œï¼›å¦ä¸€ç§æ–¹æ¡ˆæ˜¯æ–°æ·»åŸºäº Query String æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚</li></ol></li></ol></li><li>ã€<strong>æ€è·¯-2</strong>ã€‘åœ¨å‘ç° subquery çš„æ—¶å€™è¿”å›ï¼Œåœ¨ service é‡Œé¢æ‰§è¡Œä¹‹åé‡å†™ sqlï¼Œç„¶åå†æ¬¡æ‰§è¡Œã€‚</li><li>ã€<strong>æ€è·¯-3</strong>ã€‘ç°åœ¨çš„ plan_sql å‡½æ•°é‡Œé¢ä¼šæ‰§è¡Œ parser å¹¶ç”Ÿæˆ planï¼Œå¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°æ‹†æˆä¸¤ä¸ªï¼š<ol><li>ç¬¬ä¸€ä¸ªå‡½æ•°æ‰§è¡Œ parserï¼Œç”Ÿæˆ stmtï¼ŒåŒæ—¶è¿›è¡Œä¸€äº› rewriteï¼Œå¦‚æœè¿™æ—¶å‘ç°æœ‰ subquery çš„è¯ï¼Œå°±å…ˆæ‰§è¡Œä¸€ä¸‹ï¼Œç„¶å rewriteã€‚</li><li>ç¬¬äºŒä¸ªå‡½æ•°ä¼ å…¥ rewrite ä¹‹åçš„ stmtï¼Œç”Ÿæˆ planã€‚</li></ol></li></ol><p>æœ¬ç€å°½å¯èƒ½å°‘çš„æ”¹åŠ¨å½“å‰ä»£ç ç»“æ„çš„åŸåˆ™ï¼Œé€‰æ‹©**ã€æ€è·¯-1ã€‘**è¿›è¡Œå®ç°ã€‚</p><h2 id="32-review-ç›¸å…³ä¿®æ”¹"><a class="markdownIt-Anchor" href="#32-review-ç›¸å…³ä¿®æ”¹"></a> 3.2 review ç›¸å…³ä¿®æ”¹</h2><ul><li><p>ã€<strong>review-1</strong>ã€‘é¿å…ä¸å¿…è¦çš„ clone</p>  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸç‰ˆ</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">value</span> = columns[<span class="number">0</span>].<span class="title function_ invoke__">to_column</span>(block.<span class="title function_ invoke__">num_rows</span>());</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ä¿®æ”¹</span></span><br><span class="line"><span class="keyword">for</span> <span class="variable">row</span> <span class="keyword">in</span> <span class="number">0</span>..block.<span class="title function_ invoke__">num_rows</span>() &#123;</span><br><span class="line">    <span class="keyword">match</span> columns[<span class="number">0</span>].value.<span class="title function_ invoke__">index</span>(row).<span class="title function_ invoke__">unwrap</span>() &#123;</span><br><span class="line">        ScalarRef::<span class="title function_ invoke__">String</span>(s) =&gt; &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">literal</span> = Expr::Literal &#123;</span><br><span class="line">                span,</span><br><span class="line">                value: Literal::<span class="title function_ invoke__">String</span>(s.<span class="title function_ invoke__">to_string</span>()),</span><br><span class="line">            &#125;;</span><br><span class="line">            values.<span class="title function_ invoke__">push</span>(literal);</span><br><span class="line">        &#125;</span><br><span class="line">        _ =&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(ErrorCode::<span class="title function_ invoke__">SemanticError</span>(</span><br><span class="line">                <span class="string">&quot;The subquery of `pivot in` must return a string type&quot;</span>,</span><br><span class="line">            )</span><br><span class="line">            .<span class="title function_ invoke__">set_span</span>(span));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ã€<strong>review-2</strong>ã€‘é’ˆå¯¹äº subquery è¿”å›çš„æ¯ä¸ª String ä¸éœ€è¦è®¾ç½® spanï¼Œä½¿ç”¨ subquery çš„ span å³å¯ã€‚</p></li><li><p>ã€<strong>review-3</strong>ã€‘ä½¿ç”¨ <code>block.num_columns()</code> è®¡ç®— column çš„æ•°é‡ã€‚</p>  <figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸç‰ˆ</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">columns</span> = block.<span class="title function_ invoke__">columns</span>();</span><br><span class="line"><span class="keyword">if</span> columns.<span class="title function_ invoke__">len</span>() != <span class="number">1</span> &#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹å</span></span><br><span class="line"><span class="keyword">if</span> block.<span class="title function_ invoke__">num_columns</span>() != <span class="number">1</span> &#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ã€<strong>review-4</strong>ã€‘å°† sample_executor å’Œ subquery_executor åˆå¹¶æˆä¸€ä¸ª query_executorï¼Œå®ç°ä¸åŒçš„å‡½æ•°ç”¨æ¥åšåŒºåˆ†ã€‚</p></li><li><p>ã€<strong>review-5</strong>ã€‘å¯¹è¿”å›çš„ ErrorCode è®¾ç½® spanã€‚â†’ <a href="https://www.notion.so/span-123e3d1c52c68003850bf86ae43a4c3d?pvs=21">span</a></p><p>ä¸ä½¿ç”¨ spanï¼š</p>  <figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(ErrorCode::<span class="title function_ invoke__">SemanticError</span>(</span><br><span class="line">    <span class="string">&quot;The subquery of `pivot in` must return one column&quot;</span>,</span><br><span class="line">));</span><br></pre></td></tr></table></figure>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MySQL [dev]<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> monthly_sales) PIVOT(<span class="built_in">SUM</span>(amount) <span class="keyword">FOR</span> <span class="keyword">MONTH</span> <span class="keyword">IN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> <span class="keyword">month</span>, <span class="keyword">month</span> <span class="keyword">from</span> monthly_sales)) <span class="keyword">ORDER</span> <span class="keyword">BY</span> EMPID;</span><br><span class="line">ERROR <span class="number">1105</span> (HY000): SemanticError. Code: <span class="number">1065</span>, Text <span class="operator">=</span> The subquery <span class="keyword">of</span> `pivot <span class="keyword">in</span>` must <span class="keyword">return</span> <span class="keyword">one</span> column.</span><br></pre></td></tr></table></figure><hr /><p>ä½¿ç”¨ spanï¼š</p>  <figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(ErrorCode::<span class="title function_ invoke__">SemanticError</span>(</span><br><span class="line">    <span class="string">&quot;The subquery of `pivot in` must return one column&quot;</span>,</span><br><span class="line">)</span><br><span class="line">.<span class="title function_ invoke__">set_span</span>(span));</span><br></pre></td></tr></table></figure>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MySQL [dev]<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> monthly_sales) PIVOT(<span class="built_in">SUM</span>(amount) <span class="keyword">FOR</span> <span class="keyword">MONTH</span> <span class="keyword">IN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> empid <span class="keyword">from</span> monthly_sales)) <span class="keyword">ORDER</span> <span class="keyword">BY</span> EMPID;</span><br><span class="line">ERROR <span class="number">1105</span> (HY000): SemanticError. Code: <span class="number">1065</span>, Text <span class="operator">=</span> error: </span><br><span class="line">  <span class="comment">--&gt; SQL:1:78</span></span><br><span class="line">  <span class="operator">|</span></span><br><span class="line"><span class="number">1</span> <span class="operator">|</span> <span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> monthly_sales) PIVOT(<span class="built_in">SUM</span>(amount) <span class="keyword">FOR</span> <span class="keyword">MONTH</span> <span class="keyword">IN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> empid <span class="keyword">from</span> monthly_sales)) <span class="keyword">ORDER</span> <span class="keyword">BY</span> EMPID</span><br><span class="line">  <span class="operator">|</span>                                                                              <span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span><span class="operator">^</span> The subquery <span class="keyword">of</span> `pivot <span class="keyword">in</span>` must <span class="keyword">return</span> a string type</span><br><span class="line"></span><br><span class="line">.</span><br></pre></td></tr></table></figure></li></ul><h2 id="33-bugs"><a class="markdownIt-Anchor" href="#33-bugs"></a> 3.3 bugs</h2><ul><li><p>ã€<strong>bug-1</strong>ã€‘å› ä¸ºéœ€è¦ä¸¤æ¬¡ç”¨åˆ° pivot å˜é‡ï¼Œæ‰€ä»¥ä¼šæŠ¥ error: use of moved value çš„é”™è¯¯ã€‚â†’ <a href="https://www.notion.so/error-use-of-moved-value-11fe3d1c52c68078839ae6d3f66d8f62?pvs=21">error: use of moved value</a></p><p>æŠŠ pivot å’Œ unpivot æŒªå‡ºå»ï¼Œæ”¹æˆä¸¤ä¸ªå•ç‹¬çš„å‡½æ•°ã€‚</p></li><li><p>ã€<strong>bug-2</strong>ã€‘rewrite_pivot æ˜¯é async å‡½æ•°ï¼Œä½†æ˜¯ subquery_executor.execute_query_with_sql_string æ˜¯ async å‡½æ•°ï¼Œrewrite_pivot ä¸­éœ€è¦è°ƒç”¨ subquery_executor.execute_query_with_sql_stringã€‚æ‰€ä»¥ä¼šæŠ¥é”™ï¼š<code>await</code> is only allowed inside <code>async</code> functions and blocksã€‚â†’ <a href="https://www.notion.so/async-async-125e3d1c52c680008cb5e6a86c6a6554?pvs=21">åœ¨é async å‡½æ•°é‡Œè°ƒç”¨ async å‡½æ•°</a></p><p><code>databend_common_base::runtime::block_on</code></p></li></ul><h1 id="4-æµ‹è¯•"><a class="markdownIt-Anchor" href="#4-æµ‹è¯•"></a> 4 æµ‹è¯•</h1><h2 id="41-åŠŸèƒ½æµ‹è¯•"><a class="markdownIt-Anchor" href="#41-åŠŸèƒ½æµ‹è¯•"></a> 4.1 åŠŸèƒ½æµ‹è¯•</h2><p>ä¸ snowflake è¯­æ³•ä¿æŒä¸€è‡´ï¼š</p><ul><li>pivot æ”¯æŒä¸‰ç§ subqueryï¼Œ<code>from + subquery</code>ã€<code>in + subquery</code>ã€<code>from + subquery + in + subquery</code>ã€‚</li><li>unpivot åªæ”¯æŒ <code>from + subquery</code> ä¸€ç§ã€‚</li></ul><h3 id="411-æ‰‹åŠ¨æµ‹è¯•"><a class="markdownIt-Anchor" href="#411-æ‰‹åŠ¨æµ‹è¯•"></a> 4.1.1 æ‰‹åŠ¨æµ‹è¯•</h3><ul><li><p><strong>æµ‹è¯• Pivot</strong></p><ul><li><p><strong>Create the monthly_sales table</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> monthly_sales(</span><br><span class="line">  empid <span class="type">INT</span>, </span><br><span class="line">  amount <span class="type">INT</span>, </span><br><span class="line">  <span class="keyword">month</span> <span class="type">VARCHAR</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p><strong>Insert sales data</strong></p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> monthly_sales <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="number">1</span>, <span class="number">10000</span>, <span class="string">&#x27;JAN&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">400</span>, <span class="string">&#x27;JAN&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">4500</span>, <span class="string">&#x27;JAN&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">35000</span>, <span class="string">&#x27;JAN&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">5000</span>, <span class="string">&#x27;FEB&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">3000</span>, <span class="string">&#x27;FEB&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">200</span>, <span class="string">&#x27;FEB&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">90500</span>, <span class="string">&#x27;FEB&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">6000</span>, <span class="string">&#x27;MAR&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">5000</span>, <span class="string">&#x27;MAR&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">2500</span>, <span class="string">&#x27;MAR&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">9500</span>, <span class="string">&#x27;MAR&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">8000</span>, <span class="string">&#x27;APR&#x27;</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="number">10000</span>, <span class="string">&#x27;APR&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">800</span>, <span class="string">&#x27;APR&#x27;</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">4500</span>, <span class="string">&#x27;APR&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p><strong>Pivotï¼ˆåŸç‰ˆï¼‰</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> monthly_sales</span><br><span class="line">PIVOT(<span class="built_in">SUM</span>(amount) <span class="keyword">FOR</span> <span class="keyword">MONTH</span> <span class="keyword">IN</span> (<span class="string">&#x27;JAN&#x27;</span>, <span class="string">&#x27;FEB&#x27;</span>, <span class="string">&#x27;MAR&#x27;</span>, <span class="string">&#x27;APR&#x27;</span>))</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> EMPID;</span><br></pre></td></tr></table></figure></li><li><p><strong>from + subquery</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> monthly_sales)</span><br><span class="line">PIVOT(<span class="built_in">SUM</span>(amount) <span class="keyword">FOR</span> <span class="keyword">MONTH</span> <span class="keyword">IN</span> (<span class="string">&#x27;JAN&#x27;</span>, <span class="string">&#x27;FEB&#x27;</span>, <span class="string">&#x27;MAR&#x27;</span>, <span class="string">&#x27;APR&#x27;</span>))</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> EMPID;</span><br></pre></td></tr></table></figure></li><li><p><strong>in + subquery</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> monthly_sales</span><br><span class="line">PIVOT(<span class="built_in">SUM</span>(amount) <span class="keyword">FOR</span> <span class="keyword">MONTH</span> <span class="keyword">IN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> <span class="keyword">month</span> <span class="keyword">from</span> monthly_sales))</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> EMPID;</span><br></pre></td></tr></table></figure></li><li><p><strong>from + in + subquery</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> monthly_sales)</span><br><span class="line">PIVOT(<span class="built_in">SUM</span>(amount) <span class="keyword">FOR</span> <span class="keyword">MONTH</span> <span class="keyword">IN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> <span class="keyword">month</span> <span class="keyword">from</span> monthly_sales))</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> EMPID;</span><br></pre></td></tr></table></figure></li><li><p><strong>Answer</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------+-------+-------+-------+-------+</span></span><br><span class="line"><span class="operator">|</span> empid <span class="operator">|</span> jan   <span class="operator">|</span> feb   <span class="operator">|</span> mar   <span class="operator">|</span> apr   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+-------+-------+-------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> <span class="number">10400</span> <span class="operator">|</span>  <span class="number">8000</span> <span class="operator">|</span> <span class="number">11000</span> <span class="operator">|</span> <span class="number">18000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> <span class="number">39500</span> <span class="operator">|</span> <span class="number">90700</span> <span class="operator">|</span> <span class="number">12000</span> <span class="operator">|</span>  <span class="number">5300</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+-------+-------+-------+</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>æµ‹è¯• Unpivot</strong></p><ul><li><p><strong>Create the unpivoted_monthly_sales table</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> unpivoted_monthly_sales(</span><br><span class="line">  empid <span class="type">INT</span>,</span><br><span class="line">  jan <span class="type">INT</span>,</span><br><span class="line">  feb <span class="type">INT</span>,</span><br><span class="line">  mar <span class="type">INT</span>,</span><br><span class="line">  apr <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p><strong>Insert sales data</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> unpivoted_monthly_sales <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="number">1</span>, <span class="number">10400</span>,  <span class="number">8000</span>, <span class="number">11000</span>, <span class="number">18000</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="number">39500</span>, <span class="number">90700</span>, <span class="number">12000</span>,  <span class="number">5300</span>);</span><br></pre></td></tr></table></figure></li><li><p><strong>unpivotï¼ˆåŸç‰ˆï¼‰</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> unpivoted_monthly_sales</span><br><span class="line">    UNPIVOT (amount</span><br><span class="line">    <span class="keyword">FOR</span> <span class="keyword">month</span> <span class="keyword">IN</span> (jan, feb, mar, apr));</span><br></pre></td></tr></table></figure></li><li><p><strong>from + subquery</strong></p>  <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> monthly_sales_1)</span><br><span class="line">  UNPIVOT(sales <span class="keyword">FOR</span> <span class="keyword">month</span> <span class="keyword">IN</span> (jan, feb, mar, april))</span><br><span class="line">  <span class="keyword">ORDER</span> <span class="keyword">BY</span> empid</span><br></pre></td></tr></table></figure></li><li><p><strong>Answer</strong></p>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------+-------+--------+</span></span><br><span class="line"><span class="operator">|</span> empid <span class="operator">|</span> <span class="keyword">month</span> <span class="operator">|</span> amount <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+--------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> jan   <span class="operator">|</span>  <span class="number">10400</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> feb   <span class="operator">|</span>   <span class="number">8000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> mar   <span class="operator">|</span>  <span class="number">11000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span> apr   <span class="operator">|</span>  <span class="number">18000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> jan   <span class="operator">|</span>  <span class="number">39500</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> feb   <span class="operator">|</span>  <span class="number">90700</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> mar   <span class="operator">|</span>  <span class="number">12000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span> apr   <span class="operator">|</span>   <span class="number">5300</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-------+--------+</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="412-å•å…ƒæµ‹è¯•ast-ç›¸å…³"><a class="markdownIt-Anchor" href="#412-å•å…ƒæµ‹è¯•ast-ç›¸å…³"></a> 4.1.2 å•å…ƒæµ‹è¯•ï¼ˆast ç›¸å…³ï¼‰</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make unit-test</span><br></pre></td></tr></table></figure><p>parser æ”¹äº†ä¼šå¯¼è‡´ä¹‹å‰çš„æµ‹è¯•å¤±è´¥ï¼Œä¿®å¤ä¸‹é¢ä¸¤ä¸ªæ–‡ä»¶ï¼š</p><ol><li><code>src/query/ast/tests/it/testdata/stmt.txt</code></li><li><code>src/query/ast/tests/it/testdata/query.txt</code></li></ol><hr /><p>å¦å¤–åœ¨ test_query å‡½æ•°åŠ ä¸Šä¸€ä¸ª pivot &amp; unpivot å¸¦ subquery çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç›¸å…³æ–‡ä»¶ï¼š<code>src/query/ast/tests/it/parser.rs</code>ã€‚</p><h3 id="413-é€»è¾‘æµ‹è¯•sql-æ‰§è¡Œç»“æœ"><a class="markdownIt-Anchor" href="#413-é€»è¾‘æµ‹è¯•sql-æ‰§è¡Œç»“æœ"></a> 4.1.3 é€»è¾‘æµ‹è¯•ï¼ˆsql æ‰§è¡Œç»“æœï¼‰</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">make sqllogic-test</span><br></pre></td></tr></table></figure><p>ä¸ºäº†åŠ å¿«æµ‹è¯•é€Ÿåº¦ï¼Œå¯ä»¥<strong>æŒ‡å®šç›®å½•</strong>è¿›è¡Œæ‰§è¡Œï¼Œç”šè‡³å¯ä»¥<strong>ä¿®æ”¹æ–‡ä»¶å</strong>ä½¿å…¶åœ¨å½“å‰ç›®å½•å…ˆæ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./target/debug/databend-sqllogictests --handlers mysql --run_dir query</span><br></pre></td></tr></table></figure><hr /><p>æ·»åŠ  pivot &amp; unpivot ç›¸å…³ sql æŸ¥è¯¢ï¼Œç›¸å…³æ–‡ä»¶ï¼š</p><ul><li><code>tests/sqllogictests/suites/query/pivot.test</code></li><li><code>tests/sqllogictests/suites/query/unpivot.test</code></li></ul><h2 id="42-æ€§èƒ½æµ‹è¯•"><a class="markdownIt-Anchor" href="#42-æ€§èƒ½æµ‹è¯•"></a> 4.2 æ€§èƒ½æµ‹è¯•</h2><h1 id="5-éš¾ç‚¹"><a class="markdownIt-Anchor" href="#5-éš¾ç‚¹"></a> 5 éš¾ç‚¹</h1><h1 id="6-todo"><a class="markdownIt-Anchor" href="#6-todo"></a> 6 TODO</h1><h1 id="x-å‚è€ƒ"><a class="markdownIt-Anchor" href="#x-å‚è€ƒ"></a> X å‚è€ƒ</h1><ul><li><a href="https://docs.snowflake.com/en/sql-reference/constructs/pivot">https://docs.snowflake.com/en/sql-reference/constructs/pivot</a></li><li><a href="https://docs.snowflake.com/en/sql-reference/constructs/unpivot">https://docs.snowflake.com/en/sql-reference/constructs/unpivot</a></li><li><a href="https://docs.databend.com/sql/sql-commands/query-syntax/query-pivot">https://docs.databend.com/sql/sql-commands/query-syntax/query-pivot</a></li><li><a href="https://docs.databend.com/sql/sql-commands/query-syntax/query-unpivot">https://docs.databend.com/sql/sql-commands/query-syntax/query-unpivot</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-ä»»åŠ¡èƒŒæ™¯&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-ä»»åŠ¡èƒŒæ™¯&quot;&gt;&lt;/a&gt; 1 ä»»åŠ¡èƒŒæ™¯&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Issue&lt;/strong&gt;ï¼š&lt;a href=&quot;https://github.com/dat</summary>
      
    
    
    
    <category term="DB" scheme="https://dragonliu2018.github.io/categories/DB/"/>
    
    <category term="databend" scheme="https://dragonliu2018.github.io/categories/DB/databend/"/>
    
    <category term="å‡½æ•°/è¡¨è¾¾å¼" scheme="https://dragonliu2018.github.io/categories/DB/%E5%87%BD%E6%95%B0-%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
    
    <category term="pr" scheme="https://dragonliu2018.github.io/tags/pr/"/>
    
  </entry>
  
  <entry>
    <title>[doris][Status] Implement format methods for Status</title>
    <link href="https://dragonliu2018.github.io/2025/09/14/doris-Status-Implement-format-methods-for-Status/"/>
    <id>https://dragonliu2018.github.io/2025/09/14/doris-Status-Implement-format-methods-for-Status/</id>
    <published>2025-09-14T09:26:44.000Z</published>
    <updated>2025-09-23T01:05:52.936Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-issue-ä»‹ç»"><a class="markdownIt-Anchor" href="#1-issue-ä»‹ç»"></a> 1 issue ä»‹ç»</h1><p>å½“å‰ <code>Status</code> ç±»å‹è¿›è¡Œ format æ—¶ï¼Œéœ€è¦è°ƒç”¨ <code>to_string</code> å‡½æ•°ï¼š</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">fmt::format(<span class="string">&quot;&#123;&#125;&quot;</span>, status.<span class="built_in">to_string</span>());</span><br></pre></td></tr></table></figure><p>æƒ³è¦çš„æ•ˆæœæ˜¯åªéœ€è¦ä¼ å…¥ Status ç±»å‹å³å¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">fmt::format(<span class="string">&quot;&#123;&#125;&quot;</span>, status);</span><br></pre></td></tr></table></figure><h1 id="2-å®ç°"><a class="markdownIt-Anchor" href="#2-å®ç°"></a> 2 å®ç°</h1><h2 id="21-è§£æ"><a class="markdownIt-Anchor" href="#21-è§£æ"></a> 2.1 è§£æ</h2><p><code>fmt</code> åº“æä¾›äº†ä¸€ä¸ªç±»æ¨¡æ¿ <code>fmt::formatter</code>ï¼Œé€šè¿‡æ¨¡æ¿ç‰¹åŒ–ä¸º <code>Status</code> ç±»å‹æä¾›é€‚å½“çš„æ ¼å¼åŒ–æ–¹å¼ã€‚</p><p>ç„¶åå®ç° <code>parse</code> å’Œ <code>format</code> å‡½æ•°å³å¯ï¼š</p><ul><li><strong><code>parse</code></strong> å‡½æ•°è´Ÿè´£è§£ææ ¼å¼å­—ç¬¦ä¸²ã€‚åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯èƒ½ä¸éœ€è¦æä¾›è‡ªå·±çš„ <strong><code>parse</code></strong> å‡½æ•°ï¼Œè€Œå¯ä»¥ä½¿ç”¨ fmt é»˜è®¤æä¾›çš„ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬ç®€å•åœ°è¿”å›è§£æä¸Šä¸‹æ–‡çš„å¼€å§‹è¿­ä»£å™¨ã€‚</li><li><strong><code>format</code></strong> å‡½æ•°æ˜¯ç”¨æˆ·å¿…é¡»æä¾›çš„å…³é”®æˆå‘˜å‡½æ•°ã€‚å®ƒå®šä¹‰äº†å¦‚ä½•å°†è‡ªå®šä¹‰ç±»å‹æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚</li></ul><h2 id="22-åŠŸèƒ½ä»£ç "><a class="markdownIt-Anchor" href="#22-åŠŸèƒ½ä»£ç "></a> 2.2 åŠŸèƒ½ä»£ç </h2><blockquote><p>ğŸ‘‰ **å‚è€ƒï¼š**<a href="https://wgml.pl/blog/formatting-user-defined-types-fmt.html">https://wgml.pl/blog/formatting-user-defined-types-fmt.html</a></p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// specify formatter for Status</span></span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">fmt</span>::formatter&lt;doris::Status&gt; &#123;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> ParseContext&gt;</span><br><span class="line">    <span class="function"><span class="keyword">constexpr</span> <span class="keyword">auto</span> <span class="title">parse</span><span class="params">(ParseContext&amp; ctx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="built_in">begin</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FormatContext&gt;</span><br><span class="line">    <span class="function"><span class="keyword">auto</span> <span class="title">format</span><span class="params">(doris::Status <span class="type">const</span>&amp; status, FormatContext&amp; ctx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fmt::format_to(ctx.<span class="built_in">out</span>(), <span class="string">&quot;&#123;&#125;&quot;</span>, status.<span class="built_in">to_string</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="23-æµ‹è¯•ä»£ç "><a class="markdownIt-Anchor" href="#23-æµ‹è¯•ä»£ç "></a> 2.3 æµ‹è¯•ä»£ç </h2><p>å®ç°å®Œæˆåï¼Œç¼–å†™æµ‹è¯•æ ·ä¾‹ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„è¦†ç›–ç‡ã€‚</p><p>reviewer æå‡ºçš„å»ºè®®æ˜¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">please add <span class="number">3</span> testsï¼š</span><br><span class="line"><span class="number">1.</span> status == ok</span><br><span class="line"><span class="number">2.</span> status == error &amp;&amp; has stacktrace</span><br><span class="line"><span class="number">3.</span> status == error &amp;&amp; <span class="keyword">do</span> <span class="keyword">not</span> have stacktrace</span><br></pre></td></tr></table></figure><h1 id="3-é—®é¢˜"><a class="markdownIt-Anchor" href="#3-é—®é¢˜"></a> 3 é—®é¢˜</h1><h2 id="31-ld-symbols-not-found-for-architecture-x86_64"><a class="markdownIt-Anchor" href="#31-ld-symbols-not-found-for-architecture-x86_64"></a> 3.1 ld: symbol(s) not found for architecture x86_64</h2><p>åœ¨æœ¬åœ° macos ä¸Šå°è¯•å†™äº†ä¸ªæµ‹è¯•ç¨‹åºï¼Œä½†æ˜¯å‘ç”Ÿä¸‹é¢çš„æŠ¥é”™ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">âœ  test-reset git:(main) âœ— g++ test.cpp -std=c++20 -o <span class="built_in">test</span></span><br><span class="line">Undefined symbols <span class="keyword">for</span> architecture x86_64:</span><br><span class="line">  <span class="string">&quot;void fmt::v10::detail::vformat_to&lt;char&gt;(fmt::v10::detail::buffer&lt;char&gt;&amp;, fmt::v10::basic_string_view&lt;char&gt;, fmt::v10::detail::vformat_args&lt;char&gt;::type, fmt::v10::detail::locale_ref)&quot;</span>, referenced from:</span><br><span class="line">      <span class="built_in">fmt</span>::v10::appender <span class="built_in">fmt</span>::v10::vformat_to&lt;<span class="built_in">fmt</span>::v10::appender, 0&gt;(<span class="built_in">fmt</span>::v10::appender, <span class="built_in">fmt</span>::v10::basic_string_view&lt;char&gt;, <span class="built_in">fmt</span>::v10::basic_format_args&lt;<span class="built_in">fmt</span>::v10::basic_format_context&lt;<span class="built_in">fmt</span>::v10::appender, char&gt; &gt;) <span class="keyword">in</span> test-878b3f.o</span><br><span class="line">  <span class="string">&quot;fmt::v10::detail::assert_fail(char const*, int, char const*)&quot;</span>, referenced from:</span><br><span class="line">      std::__1::make_unsigned&lt;long&gt;::<span class="built_in">type</span> <span class="built_in">fmt</span>::v10::detail::to_unsigned&lt;long&gt;(long) <span class="keyword">in</span> test-878b3f.o</span><br><span class="line">  <span class="string">&quot;fmt::v10::vprint(fmt::v10::basic_string_view&lt;char&gt;, fmt::v10::basic_format_args&lt;fmt::v10::basic_format_context&lt;fmt::v10::appender, char&gt; &gt;)&quot;</span>, referenced from:</span><br><span class="line">      _main <span class="keyword">in</span> test-878b3f.o</span><br><span class="line">ld: symbol(s) not found <span class="keyword">for</span> architecture x86_64</span><br><span class="line">clang: error: linker <span class="built_in">command</span> failed with <span class="built_in">exit</span> code 1 (use -v to see invocation)</span><br></pre></td></tr></table></figure><p><strong>è§£å†³</strong>ï¼šåŸå› æ˜¯æœªé“¾æ¥ fmt åº“æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">g++ test.cpp -std=c++20 -o <span class="built_in">test</span> -lfmt</span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒ</strong>ï¼š<a href="https://stackoverflow.com/questions/56608684/how-to-use-the-fmt-library-without-getting-undefined-symbols-for-architecture-x">https://stackoverflow.com/questions/56608684/how-to-use-the-fmt-library-without-getting-undefined-symbols-for-architecture-x</a></p><h2 id="32-fmtformatter-æ¨¡æ¿ç‰¹åŒ–ä»£ç ä¸èƒ½åœ¨-doris-çš„-namespace"><a class="markdownIt-Anchor" href="#32-fmtformatter-æ¨¡æ¿ç‰¹åŒ–ä»£ç ä¸èƒ½åœ¨-doris-çš„-namespace"></a> 3.2 <code>fmt::formatter</code> æ¨¡æ¿ç‰¹åŒ–ä»£ç ä¸èƒ½åœ¨ doris çš„ namespace</h2><p>å¼€å§‹å°†ç‰¹åŒ–ä»£ç æ”¾åœ¨äº† doris namespace ä¸­ï¼Œå‘ç”Ÿäº†ä¸‹é¢çš„æŠ¥é”™ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Class template specialization of <span class="string">&#x27;formatter&#x27;</span> not <span class="keyword">in</span> a namespace enclosing <span class="string">&#x27;v8&#x27;</span> is a Microsoft extension clang(-Wmicrosoft-template)</span><br><span class="line"></span><br><span class="line">[core.h(707, 8): ] Explicitly specialized declaration is here</span><br></pre></td></tr></table></figure><p><strong>è§£å†³</strong>ï¼š</p><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> doris &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// doris code</span></span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// end doris_namespace</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// define formatter here</span></span><br></pre></td></tr></table></figure><p>**å‚è€ƒï¼š**<a href="https://github.com/fmtlib/fmt/issues/2767">https://github.com/fmtlib/fmt/issues/2767</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-issue-ä»‹ç»&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1-issue-ä»‹ç»&quot;&gt;&lt;/a&gt; 1 issue ä»‹ç»&lt;/h1&gt;
&lt;p&gt;å½“å‰ &lt;code&gt;Status&lt;/code&gt; ç±»å‹è¿›è¡Œ format æ—¶ï¼Œéœ€è¦è°ƒç”¨ &lt;code&gt;</summary>
      
    
    
    
    <category term="DB" scheme="https://dragonliu2018.github.io/categories/DB/"/>
    
    <category term="doris" scheme="https://dragonliu2018.github.io/categories/DB/doris/"/>
    
    
    <category term="pr" scheme="https://dragonliu2018.github.io/tags/pr/"/>
    
  </entry>
  
  <entry>
    <title>[Tool] Hexo ä½¿ç”¨æ•™ç¨‹</title>
    <link href="https://dragonliu2018.github.io/2025/09/13/Tool-Hexo-%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>https://dragonliu2018.github.io/2025/09/13/Tool-Hexo-%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</id>
    <published>2025-09-13T15:37:08.000Z</published>
    <updated>2025-09-23T01:03:51.746Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒå‡†å¤‡"><a class="markdownIt-Anchor" href="#ç¯å¢ƒå‡†å¤‡"></a> ç¯å¢ƒå‡†å¤‡</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">âœ  nvm --version</span><br><span class="line">0.39.1</span><br><span class="line">âœ  node -v</span><br><span class="line">v24.8.0</span><br><span class="line">âœ  npm -v</span><br><span class="line">11.6.0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®‰è£… Hexo</span></span><br><span class="line">npm install -g hexo-cli </span><br></pre></td></tr></table></figure><h1 id="æœ¬åœ°è¿è¡Œ-hexo"><a class="markdownIt-Anchor" href="#æœ¬åœ°è¿è¡Œ-hexo"></a> æœ¬åœ°è¿è¡Œ Hexo</h1><ol><li><p>åˆå§‹åŒ– hexoï¼Œç”Ÿæˆ hexo-blog ç›®å½•</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo init hexo-blog</span><br></pre></td></tr></table></figure></li><li><p>è¿›å…¥ hexo-blog ç›®å½•ï¼Œä¸‹è½½ pure ä¸»é¢˜å’Œ source æ–‡ç« </p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd hexo-blog</span><br><span class="line"></span><br><span class="line">git clone https://github.com/Dragonliu2018/hexo-theme-pure.git themes/pure</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤é»˜è®¤ç”Ÿæˆçš„ _posts ç›®å½•</span></span><br><span class="line">rm -rf source/_posts</span><br><span class="line">git clone https://github.com/Dragonliu2018/hexo-source.git source</span><br></pre></td></tr></table></figure></li><li><p>é…ç½® pureï¼Œ<a href="https://github.com/Dragonliu2018/hexo-theme-pure">ref link</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-wordcount --save</span><br><span class="line">npm install hexo-generator-json-content --save</span><br><span class="line">npm install hexo-generator-feed --save</span><br><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br><span class="line">npm install hexo-neat --save</span><br><span class="line">npm install hexo-translate-title --save</span><br><span class="line">npm un hexo-renderer-marked --save</span><br><span class="line">npm i hexo-renderer-markdown-it-plus --save</span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹ _config.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¡µé¢ä¸­åˆ†ç±»ç­‰å¯¼èˆªè¯çš„è¯­è¨€</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">language:</span> <span class="string">en</span></span><br><span class="line"><span class="string">+</span> <span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœç´¢ç•Œé¢çš„åˆ†ç±»éƒ¨åˆ†æ‹¼æ¥ url</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://example.com</span></span><br><span class="line"><span class="string">+</span> <span class="attr">url:</span> <span class="string">https://dragonliu2018.github.io</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸»é¢˜</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">theme:</span> <span class="string">landscape</span></span><br><span class="line"><span class="string">+</span> <span class="attr">theme:</span> <span class="string">pure</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®éƒ¨ç½²</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/dragonliu2018/dragonliu2018.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></li><li><p>è¿è¡Œ hexo</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure></li></ol><h1 id="éƒ¨ç½²-github"><a class="markdownIt-Anchor" href="#éƒ¨ç½²-github"></a> éƒ¨ç½² Github</h1><blockquote><p>å‚è€ƒï¼š<a href="https://hexo.io/docs/one-command-deployment">https://hexo.io/docs/one-command-deployment</a></p></blockquote><ol><li><p>å®‰è£… hexo-deployer-git</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹é¡¹ç›®æ ¹ç›®å½• blog ä¸‹çš„ <code>_config.yml</code></p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">https://github.com/dragonliu2018/dragonliu2018.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></li><li><p>éƒ¨ç½²</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure></li></ol><h1 id="å¸¸ç”¨å‘½ä»¤"><a class="markdownIt-Anchor" href="#å¸¸ç”¨å‘½ä»¤"></a> å¸¸ç”¨å‘½ä»¤</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒå‡†å¤‡&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ç¯å¢ƒå‡†å¤‡&quot;&gt;&lt;/a&gt; ç¯å¢ƒå‡†å¤‡&lt;/h1&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;spa</summary>
      
    
    
    
    <category term="Tool" scheme="https://dragonliu2018.github.io/categories/Tool/"/>
    
    <category term="Hexo" scheme="https://dragonliu2018.github.io/categories/Tool/Hexo/"/>
    
    
  </entry>
  
</feed>
